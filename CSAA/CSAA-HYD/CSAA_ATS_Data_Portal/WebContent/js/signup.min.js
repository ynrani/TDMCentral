function StringBuilder(_iv){var arr=_iv?[_iv]:[];this.append=function(v){return arr.push(v),this},this.toString=function(){return arr.join("")},this.isEmpty=function(){return this.length()<1},this.length=function(){return arr.length}}function getSubDomain(domain){for(var i=0,sdomain=domain,p=sdomain.split("."),s="_zagd"+(new Date).getTime();i<p.length-1&&-1==document.cookie.indexOf(s+"="+s);)sdomain=p.slice(-1-++i).join("."),document.cookie=s+"="+s+";domain="+sdomain+";";return document.cookie=s+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;domain="+sdomain+";",sdomain}function reloadCaptcha(idx,f,cdigest){if(f=f||idx,!f.captcha.disabled){var captchaCallback=function(cdigest){var $captcha=$(f).find(".za-captcha").attr("src",ZAConstants.getAbsoluteURL("/accounts/captcha?cdigest="+cdigest));f.cdigest||$("<input type='hidden' name='cdigest' value='"+cdigest+"'>").insertAfter($captcha),f.cdigest.value=cdigest,f.captcha.value="",f.captcha.autocomplete="off"};if(cdigest)captchaCallback(cdigest);else{var options={url:ZAConstants.getAbsoluteURL("/accounts/captcha"),type:"post",data:{action:"newcaptcha"},success:captchaCallback};window.CrossServiceRequest?CrossServiceRequest.send(options,!0):$.ajax(options)}}}function toggleField($container,show){show?$container.show().find(":input").removeAttr("disabled"):$container.hide().find(":input").attr("disabled","true")}function AjaxResponse(json){"string"==typeof json&&(json=$.parseJSON(json)),this.json=json,this.type=json[AjaxResponse.FIELDS.TYPE],this.error=json[AjaxResponse.FIELDS.ERROR],this.data=json[AjaxResponse.FIELDS.DATA]}function Form($form,options){var _this=this;if(_this.element=$form,_this.options=options=$.extend(!0,{},$.fn.form.defaults,options),_this._normalizeOptions(),_this.element.attr({action:options.url,method:options.method}),_this._initHints(),options.validator&&(this.validator=this.element.validate(options.validator)),options.passwordStrength){var pwdlen="";options.x_signup&&options.x_signup.minpwdlen&&(pwdlen=options.x_signup.minpwdlen),Form.PasswordStrength.init(options.passwordStrength,_this.element,pwdlen)}options.checkEmail&&Form.checkEmailDomain.init(options.checkEmail,_this.element,options.x_signup.domains,options.x_signup.isEmailCheck),_this.element.submit(function(event){_this.submit(event)}),options.create&&options.create.call(this),$.fn.zPlaceHolder&&options.zplaceholder_fallback&&_this.element.find("input[placeholder]").zPlaceHolder()}function signupResponse(json,textStatus,jqXHR){try{var jr=JSON.parse(json);if(jr&&"success"==jr.status)return void(window.parent.location.href=jr.redirecturl)}catch(e){}var ar=new AjaxResponse(json);if(ar.error){var f=this.element.get(0);return Form.Message.error(this.element,ar.error.msg),reloadCaptcha(f),!1}var data=ar.data,_this=this,statusCode=data.httpResponseCode,isSuccess=statusCode>=200&&300>statusCode,representation=data.representation[0],f=_this.element.get(0),$f=$(f),signupOptions=_this.options.x_signup;if(isSuccess){signupOptions.oncomplete&&signupOptions.oncomplete.call(_this,$.fn.zaSignUp.SIGNUP_STATE.ACCOUNT_CREATED,jqXHR);var customFieldData=CrossServiceRequest.toJSON("za_signup",f);if(customFieldData){var url=representation.redirect_uri,qs=representation.token_params,idx=url.indexOf(qs),params="data="+Util.euc(JSON.stringify(customFieldData));if(representation.oauthorize_uri){var options={url:representation.oauthorize_uri,type:"post",data:{is_ajax:!0}};CrossServiceRequest.send(options,_this.options.usePostMessage);var ouri=representation.oauthorize_uri,stateParam="state=",allParams=ouri.slice(ouri.indexOf(stateParam)+stateParam.length);url=decodeURIComponent(allParams.slice(0,allParams.indexOf("&")))}else params+=qs?"&"+qs:"";return CrossServiceRequest.sendToApp(signupOptions.appName,"ufields",params,{complete:function(){if(signupOptions.oncomplete&&signupOptions.oncomplete.call(_this,$.fn.zaSignUp.SIGNUP_STATE.UPDATE_SERVICE_FIELDS,jqXHR),-1!=idx){var tmpqs=(-1!=url.indexOf("?"+qs)?"?":"&")+qs;url=url.replace(tmpqs,"")}representation.redirect_uri=url,signupSucceed(_this,representation)}},_this.options.usePostMessage)}signupSucceed(_this,representation)}else{if("400"==data.httpResponseCode&&representation.redirect_uri)window.location.href=representation.redirect_uri;else if(data.errorCode){var errorObj={},errorCode=data.errorCode;if("A110"==errorCode)errorObj.captcha=I18N.get("IAM.ERROR.INVALID_IMAGE_TEXT");else if("U101"==errorCode)data.errorCause.indexOf("Invalid Mobile Number")>0?errorObj.emailormobile=I18N.get("IAM.MOBILE.ENTER.INVALID.MOBILE"):errorObj.username=data.localizedMessage;else if("U102"==errorCode)errorObj.email=data.localizedMessage;else if("U103"==errorCode)errorObj.password=data.localizedMessage;else if("PP101"===errorCode)errorObj.password=data.localizedMessage;else if("PP106"===errorCode)errorObj.password=data.localizedMessage;else if("Z114"==errorCode)errorObj.emailormobile=I18N.get("IAM.ERROR.PHONENUMBER.MOBILE.ALREADY.EXISTS");else if("Z102"==errorCode)"useremail"==data.errorResource||"emaild"==data.errorResource?errorObj.email=I18N.get("IAM.ERROR.EMAIL.EXISTS"):"username"==data.errorResource||"screenname"==data.errorResource?errorObj.username=I18N.get("IAM.ERROR.USERNAME.NOT.AVAILABLE"):errorObj.portal=I18N.get("IAM.ERROR.PORTAL.EXISTS");else if("INPUT_ERROR_102"==errorCode){if(data.errorColumn)for(var i in data.errorColumn){var column=data.errorColumn[i],field=f[column]||f[CrossServiceRequest.CONSTANTS.RESOURCE_FIELD+column];field&&(errorObj[field.name]=I18N.get("IAM.ERROR.VALID.VALUE"))}}else errorObj="Z112"==errorCode?I18N.get("IAM.ERROR.DIFFERENT.REGION",data.errorResource):data.localizedMessage||I18N.get("IAM.ERROR.GENERAL");"string"==typeof errorObj?Form.Message.error($f,errorObj):($.each(["captcha","password","email","username"],function(i,v){errorObj[v]&&f[v]&&f[v].disabled&&toggleField($f.find(".za-"+v+"-container"),!0)}),_this.showErrors(errorObj))}else Form.Message.error($f,I18N.get("IAM.ERROR.GENERAL"));reloadCaptcha(f),signupOptions.oncomplete&&signupOptions.oncomplete.call(_this,$.fn.zaSignUp.SIGNUP_STATE.ERROR,jqXHR)}}function signupSucceed(signup,representation){if(signup.options.x_signup.oncomplete&&signup.options.x_signup.oncomplete.call(signup,$.fn.zaSignUp.SIGNUP_STATE.SIGNUP_COMPLETED),!representation.email)return void(window.location.href=representation.redirect_uri);var doActionCalled=!1;signup.options.handleConfirmation.call(signup,{email:representation.email,doAction:function(){doActionCalled||(doActionCalled=!0,window.location.href=representation.redirect_uri)}})}function customFieldAudit(field,error){$.post(ZAConstants.getAbsoluteURL("/accounts/regaudit/customfield"),{field:field,error:error})}function showPassword(t){var passwordEle=$(".form .za-password-container input")[0];"password"==passwordEle.type?($(t).html(I18N.get("IAM.PASSWORD.HIDE")),passwordEle.type="text",passwordEle._zhide_timeout_=setTimeout(function(){showPassword(t)},5e3)):(clearTimeout(passwordEle._zhide_timeout_),$(t).html(I18N.get("IAM.PASSWORD.SHOW")),passwordEle.type="password")}function validateGApp(e){var val=this.domain.value;(!val||val.length<1)&&(Util.stopEvents(e),Form.Message.error(this,I18N.get("IAM.ERROR.IDP.VALID.DOMAIN")))}function togglePasswordField(pl){var password=$("#password"),type="",showpasswordicon=$("#show-password-icon");showpasswordicon.hasClass("uncheckedpass")?(type="text",showpasswordicon.removeClass("uncheckedpass").addClass("checkedpass")):(type="password",showpasswordicon.removeClass("checkedpass").addClass("uncheckedpass"));var input=$("<input>").val(password.val()).attr({id:"password",tabindex:"1",autocomplete:"off",type:type,placeholder:I18N.get("IAM.PASSWORD"),"class":password.attr("class"),name:"password",spellcheck:"false",onkeyup:"checkPasswordStrength("+pl+")",onfocus:"hideMsg(this);showPwdMsg()",onblur:"hideLenError(this,"+pl+")"});password.before(input),selectTextEnd(input[0],input.val().length),password.remove(),input.focus()}function toggleNewsletterField(){var showpasswordicon=$("#signup-newsletter");showpasswordicon.hasClass("unchecked")?(showpasswordicon.removeClass("unchecked").addClass("checked"),$("#newsletter").val(!0)):(showpasswordicon.removeClass("checked").addClass("unchecked"),$("#newsletter").val(!1))}function selectTextEnd(input,inputLen){if(input.setSelectionRange)input.setSelectionRange(inputLen,inputLen);else if(input.createTextRange){var range=input.createTextRange();range.collapse(!0),range.moveStart("character",inputLen),range.moveEnd("character",inputLen),range.select()}}function checkPasswordStrength(pl){$(".show-password").show(),$(".password-strength div").hide();var p_word=$("#password").val(),len=p_word.length,score=Form.PasswordStrength.getScore("",p_word),status=pl>=len?"weak":Form.PasswordStrength.getStatus(score);$("#pwdstrength").removeClass();var bgColor="weak"===status?"#D21C2B":"good"===status||"fair"===status?"#2489d0":"strong"===status?"#21b100":"#D21C2B";$(".pwdtext").css("color",bgColor),len>=pl?($(".pwderror").hide(),$(".pwdparent").css("marginTop","-7px"),$(".pwdparent").css("marginBottom","18px")):pl>len&&($(".pwderror").show(),$(".pwdparent").css("marginTop","0"),$(".pwdparent").css("marginBottom","0")),len>=pl&&"weak"===status?($(".pwdtext").html(I18N.get("fair"===status?"":"")),$("#pwdstrength").addClass("weak")):"fair"===status||"good"===status?($(".pwdtext").html(I18N.get("")),$("#pwdstrength").addClass("good")):"strong"===status?($(".pwdtext").html(I18N.get("")),$("#pwdstrength").addClass("strong")):$(".pwdtext").html("")}function hideMsg(t){Form.Message.hideError(t),$(".za-email-suggestion").is(":visible")&&$(".za-email-suggestion").remove()}function hideLenError(t,n){Form.Message.hideError(t);var p_word=$("#password").val(),len=p_word.length;len>=1&&n>len&&($("#errormg").removeClass("pwderror"),$("#errormg").addClass("dummyerror"),Form.Message.create($(t),"error","").addClass("jqval-error"),$("#password").addClass("temperror"))}function showPwdMsg(){$("#errormg").removeClass("dummyerror"),$("#errormg").addClass("pwderror"),$(".captchaCnt").css("marginTop","0"),$("#password").removeClass("temperror"),$("#errormg").is(":visible")||($("#errormg").slideDown(100),$(".za-newsletter-container label").css("marginTop","2px"))}function injectLocationForm(options){if(isEu(options)){var select=document.createElement("select");select.classList.add("za-region-select"),select.classList.add("ignore-validation"),select.dclpfxcookiename=options.x_signup.dclCookieName,$(select).css("width","115px");var depMap=options.x_signup.zLocations;for(var dep in depMap){var option=document.createElement("option");option.value=depMap[dep].url,option.text=dep,option.code=depMap[dep].code,options.x_signup.zCurLoc==dep&&(option.selected="selected"),select.add(option)}select.onchange=function(e){var form=$(".form"),selectedOption=this.getElementsByTagName("option")[this.selectedIndex];setCookie(this.dclpfxcookiename,selectedOption.code);var acc_url=e.target.value;form.zaSignUp("options").ajax.url=acc_url+"/accounts/register.ac",form.zaSignUp("options").url=acc_url+"/accounts/register.ac",ZAConstants.setAccountsServer(acc_url),form.validate().resetForm()},$(".za-region-container").length>0?$(".za-region-container").append(select):$(".form").prepend(select)}else $(".za-region-container").css("display","none")}function setCookie(name,value){var host=document.location.host;host=host.substring(host.indexOf("."));var cookieStr=name+"="+value+";Path=/;";cookieStr+="domain="+host,document.cookie=cookieStr}function isEu(options){var date=new Date;if(date.getTimezoneOffset()<=0&&date.getTimezoneOffset()>=-180){var euTZ=["(CEST)","(WEST)","(WET)","(EET)","(WEST)","(EEST)","(CET)"],thisTZ=date.toString().toUpperCase();for(var i in euTZ)if(thisTZ.indexOf(euTZ[i])>-1)return!0}return options.x_signup.isEU||!1}function checkmblbox(id){var check=de(id);check.checked?($("#checkbx").removeClass("checkedBox"),$("#checkbx").addClass("uncheckBox")):($("#checkbx").removeClass("uncheckBox"),$("#checkbx").addClass("checkedBox"))}var PasswordStrength=function(){var MULTIPLE_NUMBERS_RE=/\d.*?\d.*?\d/,MULTIPLE_SYMBOLS_RE=/[!@#$%^&*?_~].*?[!@#$%^&*?_~]/,UPPERCASE_LOWERCASE_RE=/([a-z].*[A-Z])|([A-Z].*[a-z])/,SYMBOL_RE=/[!@#\$%^&*?_~]/;this.username=null,this.password=null,this.score=0,this.status=null,this.test=function(){return this.score=0,this.containInvalidMatches()?this.status="invalid":(this.score+=this.scoreFor("password_size"),this.score+=this.scoreFor("numbers"),this.score+=this.scoreFor("symbols"),this.score+=this.scoreFor("uppercase_lowercase"),this.score+=this.scoreFor("numbers_chars"),this.score+=this.scoreFor("numbers_symbols"),this.score+=this.scoreFor("symbols_chars"),this.score+=this.scoreFor("only_chars"),this.score+=this.scoreFor("only_numbers"),this.score+=this.scoreFor("username"),this.score+=this.scoreFor("sequences"),this.score+=this.scoreFor("repetitions"),this.score<0&&(this.score=0),this.score>100&&(this.score=100),this.score<35&&(this.status="weak"),this.score>=35&&this.score<70&&(this.status="good"),this.score>=70&&(this.status="strong")),this.score},this.scoreFor=function(name){switch(score=0,name){case"password_size":score=this.password.length<4?-100:4*this.password.length;break;case"numbers":this.password.match(MULTIPLE_NUMBERS_RE)&&(score=5);break;case"symbols":this.password.match(MULTIPLE_SYMBOLS_RE)&&(score=5);break;case"uppercase_lowercase":this.password.match(UPPERCASE_LOWERCASE_RE)&&(score=10);break;case"numbers_chars":this.password.match(/[a-z]/i)&&this.password.match(/[0-9]/)&&(score=15);break;case"numbers_symbols":this.password.match(/[0-9]/)&&this.password.match(SYMBOL_RE)&&(score=15);break;case"symbols_chars":this.password.match(/[a-z]/i)&&this.password.match(SYMBOL_RE)&&(score=15);break;case"only_chars":this.password.match(/^[a-z]+$/i)&&(score=-15);break;case"only_numbers":this.password.match(/^\d+$/i)&&(score=-15);break;case"username":this.password==this.username?score=-100:-1!=this.password.indexOf(this.username)&&(score=-15);break;case"sequences":score+=-15*this.sequences(this.password),score+=-15*this.sequences(this.reversed(this.password));break;case"repetitions":score+=-(4*this.repetitions(this.password,2)),score+=-(3*this.repetitions(this.password,3)),score+=-(2*this.repetitions(this.password,4))}return score},this.isGood=function(){return"good"==this.status},this.isWeak=function(){return"weak"==this.status},this.isStrong=function(){return"strong"==this.status},this.isInvalid=function(){return"invalid"==this.status},this.isValid=function(level){return"strong"==level?this.isStrong():"good"==level?this.isStrong()||this.isGood():!this.containInvalidMatches()},this.containInvalidMatches=function(){return this.exclude&&this.exclude.test?this.exclude.test(this.password.toString()):!1},this.sequences=function(text){for(var previousCode,currentCode,matches=0,sequenceSize=0,codes=[],len=text.length,i=0;len>i;i++)currentCode=text.charCodeAt(i),previousCode=codes[codes.length-1],codes.push(currentCode),previousCode&&(currentCode==previousCode+1||previousCode==currentCode?sequenceSize+=1:sequenceSize=0),2==sequenceSize&&(matches+=1);return matches},this.repetitions=function(text,size){for(var substring,occurrences,tmpText,count=0,matches={},len=text.length,i=0;len>i;i++)if(substring=text.substr(i,size),occurrences=0,tmpText=text,!(matches[substring]||substring.length<size)){for(matches[substring]=!0;-1!=(i=tmpText.indexOf(substring));)occurrences+=1,tmpText=tmpText.substr(i+1);occurrences>1&&(count+=1)}return count},this.reversed=function(text){for(var newText="",len=text.length,i=len-1;i>=0;i--)newText+=text.charAt(i);return newText}};PasswordStrength.test=function(username,password){return strength=new PasswordStrength,strength.username=username,strength.password=password,strength.test(),strength},function(b){b.fn.mailcheck=function(a,b){var d="yahoo.com,google.com,hotmail.com,gmail.com,me.com,aol.com,mac.com,live.com,comcast.net,googlemail.com,msn.com,hotmail.co.uk,yahoo.co.uk,facebook.com,verizon.net,sbcglobal.net,att.net,gmx.com,mail.com".split(","),e="co.uk,com,net,org,info,edu,gov,mil".split(",");if("object"==typeof a&&void 0===b)a.domains=a.domains||d;else{var g=a,a=b;a.domains=g||d}a.topLevelDomains=a.topLevelDomains||e,a.distanceFunction=Kicksend.sift3Distance,(d=Kicksend.mailcheck.suggest(encodeURI(this.val()),a.domains,a.topLevelDomains,a.distanceFunction))?a.suggested&&a.suggested(this,d):a.empty&&a.empty(this)}}(jQuery);var Kicksend={mailcheck:{threshold:3,suggest:function(b,a,c,d){if(b=b.toLowerCase(),b=this.splitEmail(b),a=this.findClosestDomain(b.domain,a,d)){if(a!=b.domain)return{address:b.address,domain:a,full:b.address+"@"+a}}else if(c=this.findClosestDomain(b.topLevelDomain,c),b.domain&&c&&c!=b.topLevelDomain)return a=b.domain,a=a.substring(0,a.lastIndexOf(b.topLevelDomain))+c,{address:b.address,domain:a,full:b.address+"@"+a};return!1},findClosestDomain:function(b,a,c){var d,e=99,g=null;if(!b||!a)return!1;c||(c=this.sift3Distance);for(var f=0;f<a.length;f++){if(b===a[f])return b;d=c(b,a[f]),e>d&&(e=d,g=a[f])}return e<=this.threshold&&null!==g?g:!1},sift3Distance:function(b,a){if(null==b||0===b.length)return null==a||0===a.length?0:a.length;if(null==a||0===a.length)return b.length;for(var c=0,d=0,e=0,g=0;c+d<b.length&&c+e<a.length;){if(b.charAt(c+d)==a.charAt(c+e))g++;else for(var f=e=d=0;5>f;f++){if(c+f<b.length&&b.charAt(c+f)==a.charAt(c)){d=f;break}if(c+f<a.length&&b.charAt(c)==a.charAt(c+f)){e=f;break}}c++}return(b.length+a.length)/2-g},splitEmail:function(b){if(b=b.split("@"),2>b.length)return!1;for(var a=0;a<b.length;a++)if(""===b[a])return!1;var c=b.pop(),d=c.split("."),e="";if(0==d.length)return!1;if(1==d.length)e=d[0];else{for(a=1;a<d.length;a++)e+=d[a]+".";2<=d.length&&(e=e.substring(0,e.length-1))}return{topLevelDomain:e,domain:c,address:b.join("@")}}}},ZAConstants={csrfParam:null,csrfCookie:null,contextpath:"/accounts",load:function(json){this.config=json,$.each("accountsServer,csrfParam,csrfCookie,js_url,css_url,img_url".split(","),function(i,key){var v=json[key];v&&(ZAConstants[key]=v)})},setAccountsServer:function(serverURL){if(-1==serverURL.indexOf("://"))throw"Invalid Protocol given for the URL : "+serverURL;this.accountsServer=serverURL,this.schemeLessAccountsServer=null},getAccountsServer:function(){return!this.schemeLessAccountsServer&&this.accountsServer&&(this.schemeLessAccountsServer=this.accountsServer.substring(this.accountsServer.indexOf("://")+1)),this.schemeLessAccountsServer},getAbsoluteURL:function(path){return this.getAccountsServer()+path}};$.isFunction(String.prototype.trim)||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});var _xxxHTTP="http__://".replace("__",""),_xxxHTTPS="https__://".replace("__","");!function($){function processField(idx,input){var $input=$(input),placeholder=$input.attr("placeholder");$input.attr("title")||$input.attr("title",placeholder);var $overlay=$("<span />").addClass("zph-overlay").html(placeholder).css("font-size",$(input).css("font-size"));$input.removeAttr("placeholder").keydown(toggleClass).parent().addClass("zph-placeholder").prepend($overlay),$overlay.click(function(){$input.focus()}),toggleClass(null,$input)}function toggleClass(e,t){var $input=$(t||this);setTimeout(function(){var value=$input.val();0==value?$input.parent().removeClass("zph-hide").addClass("zph-show"):$input.parent().removeClass("zph-show").addClass("zph-hide")},0)}$.support.zplaceholder="placeholder"in document.createElement("input"),$.fn.zPlaceHolder=function(){(!$.support.zplaceholder||$.browser&&$.browser.msie&&!(parseInt($.browser.version)<10))&&this.each(processField)}}(jQuery);var Cookie={add:function(cn,cv,domain,maxage,secure){document.cookie=cn+"="+escape(cv)+";path=/"+(domain?";domain="+domain:"")+(maxage?";max-age="+maxage:"")+(secure?";secure="+secure:"")},get:function(cn){if(document.cookie.length>0){var beginIdx=document.cookie.indexOf(cn+"=");if(-1!=beginIdx){beginIdx=beginIdx+cn.length+1;var endIdx=document.cookie.indexOf(";",beginIdx);return-1==endIdx&&(endIdx=document.cookie.length),unescape(document.cookie.substring(beginIdx,endIdx))}}return""},append:function(cn,cv,domain,separator,maxage,secure){var oldcv=Cookie.get(cn),newcv="";newcv=oldcv?oldcv+separator+cv:cv,Cookie.add(cn,newcv,domain,maxage,secure)},remove:function(cn){document.cookie=cn+"=remove;path=/;max-age=0"}},I18N={data:{},load:function(arr){return $.extend(this.data,arr),this},get:function(key,args){if("object"==typeof key){for(var i in key)key[i]=I18N.get(key[i]);return key}var msg=this.data[key]||key;return args?(arguments[0]=msg,Util.format.apply(this,arguments)):msg}},Util={euc:function(value){return encodeURIComponent(value)},duc:function(value){return decodeURIComponent(value)},paramConfigure:function(args){var params=Util.parseParameter(location.search);$("html").hide(),$(document).ready(function(){$.each(params,function(pname,pvalue){pvalue="true"===pvalue;var value=args[pname];"string"==typeof value?$(value)[pvalue?"show":"hide"]():pvalue&&"object"==typeof value?$.each(value,function(selector,attrObj){$(selector).attr(attrObj)}):pvalue&&"function"==typeof value&&args[pname]()})}),$("html").show()},getCSRFValue:function(){return ZAConstants.csrfParam+"="+Util.euc(Cookie.get(ZAConstants.csrfCookie))},addCSRFParam:function(arr){return arr=arr||{},arr[ZAConstants.csrfParam]=Cookie.get(ZAConstants.csrfCookie),arr},parseParameter:function(qs){var paramArr={};if(-1==qs.indexOf("="))return paramArr;"?"==qs.charAt(0)&&(qs=qs.substring(1));for(var params=qs.split("&"),i=0;i<params.length;i++){var pArr=params[i].split("="),pN=decodeURIComponent(pArr[0]),pV=decodeURIComponent(pArr[1]),pOldV=paramArr[pN];pOldV?$.isArray(pOldV)?pOldV.push(pV):paramArr[pN]=[pOldV,pV]:paramArr[pN]=pV}return paramArr},serializeParams:function(obj){var sb=new StringBuilder;for(var k in obj){var v=obj[k];if(v)if(sb.isEmpty()||sb.append("&"),$.isArray(v))for(var first=!0,j=0;j<v.length;j++)first||sb.append("&"),sb.append(Util.euc(k)).append("=").append(Util.euc(v[j])),first=!1;else sb.append(Util.euc(k)).append("=").append(Util.euc(v))}return sb.toString()},stopEvents:function(e){e.stopPropagation?(e.preventDefault(),e.stopPropagation()):(e.cancelBubble=!0,e.returnValue=!1)},includeJSON2:function(){var json=window.JSON;if(!$.isFunction(json&&json.parse&&json.stringify)){var e=document.createElement("script");e.src=ZAConstants.js_url+"/js/tplibs/json2.js",e.type="text/javascript",document.body.appendChild(e)}},redirectToHTTPS:function(){var https=new StringBuilder("h").append("ttps://"),url=window.location.href;if(0!=url.indexOf(https)){var http=new StringBuilder("h").append("ttp://"),port=window.location.port;(0==port.length||"80"==port||"8080"==port)&&(window.location.href=url.replace(http,https).replace("8080","8443"))}},format:function(msg){if(msg)for(var i=1;i<arguments.length;i++)msg=msg.replace(new RegExp("\\{"+(i-1)+"\\}","g"),arguments[i]);return msg},updateOrigin:function(d){var domain=d||location.hostname,subdomain=getSubDomain(domain);return document.domain!==subdomain?(document.domain=subdomain,subdomain):void 0},valueOf:function(value,context){return $.isFunction(value)?value.call(context||this):value},getServerURL:function(url){if(0===url.indexOf("//")&&(url=window.location.protocol+url),0!==url.indexOf(_xxxHTTP)&&0!==url.indexOf(_xxxHTTPS))return null;var idx=url.indexOf("/",8);return-1===idx?url:url.substring(0,idx)}};AjaxResponse.FIELDS={TYPE:"t",ERROR:"error",DATA:"data"};var CrossServiceRequest={CONSTANTS:{RESOURCE_FIELD:"r_",CUSTOM_FIELD:"x_"},appURLs:{},currentForm:null,corsOptions:{type:"POST",crossDomain:!0,xhrFields:{withCredentials:!0}},postMessageOptions:{data:{_pmsg:!0}},jsSameOriginOptions:{data:{_corsfn:"CrossServiceRequest.handleFrameCallback"}},send:function(url,_options,usePostMessage){var options=options||{};if("object"==$.type(url)?(usePostMessage=_options,options=url):$.isFunction(options)?options={url:url,success:options}:(options.url=url,usePostMessage=options),0!=options.url.indexOf("http")&&0!=options.url.indexOf("//")&&(options.url=ZAConstants.getAbsoluteURL(options.url)),$.support.cors&&!usePostMessage)options=$.extend(!0,{},options,this.corsOptions),$.ajax(options);else{usePostMessage=usePostMessage&&!!window.postMessage;var iframeOptions=usePostMessage?this.postMessageOptions:this.jsSameOriginOptions,isDataInString=options.data&&"string"==$.type(options.data);if(isDataInString){var actualData=options.data;options=$.extend(!0,{},options,iframeOptions),options.data=actualData+"&"+$.zaParam(iframeOptions.data)}else options=$.extend(!0,{},options,iframeOptions);this.currentIFrame=CrossServiceRequest.insertCORSFrame();var $form=$("<form></form>",{action:options.url,method:"POST",autocomplete:"off",target:"corsFrame"});$.each(isDataInString?options.data.split("&"):options.data,function(k,v,i){if(isDataInString){i=k;var vArr=v.split("=");k=Util.duc(vArr[0]),v=Util.duc(vArr[1])}$("<input>",{type:"hidden",name:k,value:v}).appendTo($form)}),this.currentForm=$form.appendTo(document.body).data("__cors_options__",options),usePostMessage?$(window).one("message",{requestURL:options.url},CrossServiceRequest.handleReceiveMessage):Util.updateOrigin(),this.currentForm.submit()}},insertCORSFrame:function(){var $frame=$("iframe[name='corsFrame']");return $frame.length||($frame=$('<iframe src="'+ZAConstants.img_url+'/images/spacer.gif" name="corsFrame" frameborder="0" scrolling="no" style="display:none;border: none;margin: 0;width: 0;"></iframe>').appendTo(document.body)),$frame},handleResponse:function(data){var options=CrossServiceRequest.currentForm.data("__cors_options__");CrossServiceRequest.currentForm.remove(),CrossServiceRequest.currentForm=null,options.complete&&options.complete.call(options.context||this,data),options.success&&options.success.call(options.context||this,data)},handleFrameCallback:function(data){CrossServiceRequest.handleResponse(data)},handleReceiveMessage:function(_ev){var ev=_ev.originalEvent;if(!ev.origin||Util.getServerURL(_ev.data.requestURL)!==ev.origin)throw new Error("Message recevied from invalid origin. Origin : "+ev.origin+", Expected : "+_ev.data.requestURL);if(!ev.source||ev.source!==CrossServiceRequest.currentIFrame.get(0).contentWindow)throw new Error("Message recevied from invalid source");var data;try{data=$.parseJSON(ev.data)}catch(e){data=ev.data}CrossServiceRequest.handleResponse(data)},toJSON:function(screen,f,extraParams){for(var params={},hasCustomParam=!1,fields=$(f).serializeArray(),i=0;i<fields.length;i++){var field=fields[i],name=field.name;hasCustomParam||0!=name.indexOf(CrossServiceRequest.CONSTANTS.CUSTOM_FIELD)||(hasCustomParam=!0),"true"!=$(f[name]).data("secret")&&(params[name]=field.value)}return hasCustomParam?{v1:$.extend(!0,{screen:screen,params:params},extraParams)}:null},getAjaxOptions:function(appName,method,data,callback){var url=this.appURLs[appName]+"/~za~/"+appName+"/"+method,options={url:url,data:data,type:"POST",dataType:"json"};return $.isFunction(callback)?options.success=callback:callback&&$.extend(!0,options,callback),options},sendToApp:function(appName,method,data,callback,usePostMessage){var options=this.getAjaxOptions(appName,method,data,callback);return CrossServiceRequest.send(options,usePostMessage)}},__za_r20=/\+/g;$.zaParam=function(obj){var str=$.param(obj);return str?str.replace(__za_r20,"%20"):str},$.fn.zaSerialize=function(){return $.zaParam(this.serializeArray())},$.fn.form=function(options){if(!this.length)return this;var f=this.data("__form_obj__");if(f){if("string"==typeof options&&"_"!==options.charAt(0)){var value=f[options];if($.isFunction(f[options]))return value.apply(f,Array.prototype.slice.apply(arguments).splice(1));if(void 0!==value)return value}}else f=new Form(this,options),this.data("__form_obj__",f);return this},$.fn.form.defaults={create:null,url:null,method:"post",params:null,handleParams:null,crossdomain:!1,usePostMessage:!1,csrf:!0,commonerror:!1,success:null,error:null,ajax:{},validator:{},onsubmit:null,oncomplete:null,passwordStrength:null,hints:null,animateError:!0,submitButton:":submit",disableSubmit:!0,zplaceholder_fallback:!0},$.fn.form.validatorOptions={debug:!0,errorElement:"span",onsubmit:!1,onkeyup:function(element){var validator=this,timeoutKey=element.name+"_timeout";validator.za||(validator.za={}),clearTimeout(validator.za[timeoutKey]),validator.za[timeoutKey]=setTimeout(function(){(element.name in validator.submitted||""!=$(element).val())&&validator.element(element)},validator.settings.onkeyupdelay||500)},showErrors:function(errorMap){var $form=$(this.currentForm),options=$form.zaSignUp("options");options.commonerror?$.isEmptyObject(errorMap)?$form.zaSignUp("hideErrors",$form):$form.zaSignUp("showErrors",errorMap):this.defaultShowErrors()},errorPlacement:function(error,$input){Form.Message.create($input,"error",error).addClass("jqval-error")},highlight:function(input){Form.Message.error(input)},unhighlight:function(input){Form.Message.hideError(input)},success:function($error){Form.Message.valid($error.parent().parent())}},Form.prototype._normalizeOptions=function(){var _this=this,options=_this.options;if(options.url=_this._val(options.url)||_this.element.attr("action"),options.method=options.method||_this.element.attr("method"),$.isEmptyObject(options.validator))options.validator=null;else{var oldKeyUp=options.validator.onkeyup;options.validator=$.extend(!0,{},$.fn.form.validatorOptions,options.validator),options.validator.onkeyup=oldKeyUp===!0?$.fn.form.validatorOptions.onkeyup:oldKeyUp||!1}options.ajax=$.extend(!0,{url:options.url,type:options.method,context:_this,complete:_this._complete,success:options.success,error:options.error},options.ajax)},Form.prototype._val=function(value){return $.isFunction(value)?value.call(this):value},Form.prototype._initHints=function(){var _this=this,hints=_this.options.hints;for(var k in hints){var formEle=_this.element[0][k],$input=formEle&&formEle.nodeType===Node.ELEMENT_NODE?$(formEle):_this.element.find(k);Form.Message.element($input,"note").html(_this._val(hints[k]))}return this},Form.prototype._complete=function(jqXHR,textStatus){var _this=this,options=this.options;_this.updateSubmitState(!1),options.oncomplete&&options.oncomplete.call(this,jqXHR,textStatus)},Form.prototype.validate=function(){return this.validator?this.element.valid():!0},Form.prototype.showErrors=function(errorObj){if(this.options.commonerror)for(var i in errorObj)return Form.Message.error(this.element,errorObj[i]),!1;if(this.validator)this.validator.showErrors(errorObj),this.validator.focusInvalid();else{Form.Message.errors(this.element,errorObj);var f=this.element.get(0);for(var i in errorObj)if(f[i]){f[i].focus();break}}},Form.prototype.hideErrors=function(fields){Form.Message.hideErrors(this.element,fields)},Form.prototype.submit=function(event){Util.stopEvents(event);var _this=this,options=_this.options,$errorFields=options.animateError&&_this.element.find(".field-error");if(Form.Message.hideError(_this.element),!_this.validate())return _this.validator.focusInvalid(),options.animateError&&$errorFields.size()==_this.element.find(".field-error").size()&&$errorFields.fadeOut(function(){$(this).fadeIn()}),!1;if(_this.validator&&_this.validator.pendingRequest)return void(_this.validator.formSubmitted=!0);var params=null;if(options.handleParams)params=options.handleParams.call(this);else if(params=_this.element.zaSerialize(),options.csrf&&"post"==options.method&&(params+="&"+Util.getCSRFValue()),options.params){var optParams=this._val(options.params);params+="&"+("object"==typeof optParams?Util.serializeParams(optParams):optParams)}var ajaxOptions=$.extend(!0,{data:params},options.ajax),onSubmitValue=options.onsubmit&&options.onsubmit.call(this,ajaxOptions);return onSubmitValue===!1?!1:(_this.updateSubmitState(!0),void(options.crossdomain===!0?CrossServiceRequest.send(ajaxOptions,options.usePostMessage):$.ajax(ajaxOptions)))},Form.prototype.updateSubmitState=function(disable){var options=this.options;if(options.submitButton&&options.disableSubmit){var $btn=this.element.find(options.submitButton),disableValue=this._val(options.disableSubmit);disable?($btn.attr("disabled","true").addClass("disable-btn"),"string"==typeof disableValue&&$btn.data("za_form_original_value",$btn.val()).val(disableValue)):($btn.removeAttr("disabled").removeClass("disable-btn"),"string"==typeof disableValue&&$btn.val($btn.data("za_form_original_value")||$btn.val()))}},Form.Message={valid:function(selector){var $input=$(selector);return this.isForm($input)?this.element($input,"error").hide():$input.parent().addClass("field-valid"),$input},errors:function($f,obj){for(var k in obj)this.error($f.find("[name='"+k+"']"),obj[k])},hideErrors:function($f,fields){for(var i=0;i<fields.length;i++){var v=fields[i];this.hideError("string"==typeof v?$f.find("[name='"+v+"']"):v)}},error:function(selector,msg){var $input=$(selector);return msg&&this.element($input,"error").html(msg),this.isForm($input)?this.element($input,"error").css("display","block"):$input.parent().addClass("field-error").removeClass("field-valid"),$input},hideError:function(selector){var $input=$(selector);return this.isForm($input)?this.element($input,"error").hide():$input.parent().removeClass("field-error"),$input},isForm:function($e){return $e.is("form")||$e.is(".form")},element:function($input,type){var $msg=this.isForm($input)?$input.find("> .field-msg ."+type):$input.parent().find(".field-msg ."+type);return $msg.length?$msg:this.create($input,type)},create:function($input,type,msg){var $msgobj,isForm=this.isForm($input),$fieldMsg=isForm?$input.children(".field-msg"):$input.siblings(".field-msg");return $fieldMsg.length||($fieldMsg=$("<div class='field-msg'></div>")[isForm?"prependTo":"insertAfter"]($input)),$msgobj=msg&&"string"!=typeof msg?$(msg):$("<span class='"+type+"'></span>").html(msg),$msgobj.appendTo($fieldMsg)}},Form.PasswordStrength={UI:'<div class="password-strength"><div></div></div>',COLORS:{weak:"#EA0206",fair:"#F2E148",good:"#90EE90",strong:"#1DB232"},_create:function($input){return $(Form.PasswordStrength.UI).appendTo($input.parent().css("position","relative"))},init:function(selector,context,pwdlen){$(selector,context).each(function(){var $input=$(this);$input.siblings(".password-strength").length||(Form.PasswordStrength._create($input),$input.keyup(function(){var username=this.form&&this.form.username&&this.form.username.value;$input.attr("ps-username")&&(username=$($input.attr("ps-username"),this.form).val()),Form.PasswordStrength.check(this,username,pwdlen)}))})},getStatus:function(score){return 30>score?"weak":score>=30&&60>score?"fair":score>=60&&80>score?"good":"strong"},getScore:function(username,value){return PasswordStrength.test(username,value).score},check:function(passwordEle,username,pwdlen){var $password=$(passwordEle),value=$password.val().trim(),$ps=$password.siblings(".password-strength");if(value.length>=1){var score=pwdlen&&value.length<pwdlen?"10":Form.PasswordStrength.getScore(username,value),bgColor=Form.PasswordStrength.COLORS[Form.PasswordStrength.getStatus(score)]||Form.PasswordStrength.COLORS.good;$ps.length||($ps=Form.PasswordStrength._create($password));var defaultWidth=0===score?5:score;$ps.show().find("div").width(defaultWidth+"%").css("background-color",bgColor)}else $ps.hide()}},Form.checkEmailDomain={UI:'<div class="za-email-suggestion"><div></div></div>',_create:function($input){return $(Form.checkEmailDomain.UI).appendTo($input.parent().css("position","relative"))},init:function(selector,context,domains,isEmailCheck){return isEmailCheck?void $(selector,context).each(function(){var $input=$(this);$input.siblings(".za-email-suggestion").length||(Form.checkEmailDomain._create($input),$input.blur(function(){Form.checkEmailDomain.check($input,domains.split(","))}))}):!1},check:function(id,domains){var $suggest=id.siblings(".za-email-suggestion");$suggest.length||Form.checkEmailDomain._create(id);var suggestion=Form.checkEmailDomain.getSuggestedDomain(id,domains),oldemail=$('input[name="email"]').val(),domain=oldemail.split("@"),domainpart=domain[1],dvallength=0;if(domainpart){var dval=domainpart.split(".");dvallength=dval.length;var domval=dval[dvallength];length=domval?domval.trim().length:0}for(var whitelist="ymail.com,yahoo.co.,yahoo.com.,hotmail.co.,hotmail.com.,gmx.net,gmx.at,gmx.ch,gmx.com,mail.com,web.com",whitelist_regex=whitelist.split(","),containInWhiteList=!1,i=0;i<whitelist_regex.length;i++)if(domainpart&&domainpart.match(whitelist_regex[i].trim())){containInWhiteList=!0;break}if(dvallength>2)return!1;if(containInWhiteList)return!1;if(suggestion){var emailAddress="<a onclick = \"Form.checkEmailDomain.replaceDomain('"+suggestion.full.trim()+"')\"><span>"+suggestion.address+'</span>@<span class="za-email-domain">'+suggestion.domain+"</span></a>",message=I18N.get("IAM.DOMAIN.CHECK_MESSAGE",emailAddress);id.siblings(".field-msg").children().is(":visible")&&(Form.Message.hideError(id),message="<span class='za-domain-error'>"+I18N.get("IAM.EMAIL.DOMAIN.SUGGESTION.FULL",emailAddress)+"</span>"),$(".za-email-suggestion").html(message)}else $(".za-email-suggestion").remove()},replaceDomain:function(email){$('input[name="email"]').val(email),$(".za-email-suggestion").remove()},getSuggestedDomain:function(id,domains){var suggestedValue="";return $(id).mailcheck({domains:domains,suggested:function(element,suggestion){-1!==suggestion.domain.indexOf(".")&&(suggestedValue=suggestion)},empty:function(){}}),suggestedValue}};var Validator={PATTERN:{STARTS_ALPHA_NUMERIC:/^[A-Za-z0-9]/,ENDS_ALPHA_NUMERIC:/[A-Za-z0-9]$/,CONTINUE_DOT:/([._][._])+/,VALID_CHARS:/^[A-Za-z0-9_\.]+$/,ONLY_NUMERIC:/^[0-9]+$/,EMAIL:/^[\w]([\w\-\.\+\']*)@([\w\-\.]*)(\.[a-zA-Z]{2,22}(\.[a-zA-Z]{2}){0,2})$/i,USERNAME:/^[A-Za-z0-9_.]+$/i,MOBILE:/^([0-9]{8,12})$/},isValid:function(value){return value&&value.trim().length>0},isEmail:function(value){return value&&Validator.PATTERN.EMAIL.test(value.trim())},isUserName:function(value){return value&&Validator.PATTERN.USERNAME.test(value.trim())},isMobile:function(value){return 0!=value.trim().length&&Validator.PATTERN.MOBILE.test(value.trim())},setJQueryMessage:function($validator,msg,element){return msg?($validator.settings.messages[element.name]=I18N.get(msg),!1):!0}};Validator.newPortal=function(value,element){value=value.trim();var msg=null;return value.length<1?msg="IAM.ERROR.PORTAL.MANDATORY":value.length<6||value.length>30?msg="IAM.ERROR.PORTAL.NOOF.CHARS":Validator.PATTERN.STARTS_ALPHA_NUMERIC.test(value)?Validator.PATTERN.VALID_CHARS.test(value)?Validator.PATTERN.CONTINUE_DOT.test(value)?msg="IAM.ERROR.PORTAL.CONSECUTIVE.DOTS":Validator.PATTERN.ENDS_ALPHA_NUMERIC.test(value)?Validator.PATTERN.ONLY_NUMERIC.test(value)&&(msg="IAM.ERROR.PORTAL.ONLYNUMBERS"):msg="IAM.ERROR.PORTAL.ENDSWITH":msg="IAM.ERROR.PORTAL.NAME.RESTRICTION":msg="IAM.ERROR.PORTAL.STARTSWITH",this.settings?Validator.setJQueryMessage(this,msg,element):I18N.get(msg)},Validator.newUsername=function(value,element){value=value.trim();var msg=null;return value.length<1?msg="IAM.ERROR.USERNAME.MANDATORY":value.length<6||value.length>30?msg="IAM.ERROR.USERNAME.NOOF.CHARS":Validator.PATTERN.STARTS_ALPHA_NUMERIC.test(value)?Validator.PATTERN.VALID_CHARS.test(value)?Validator.PATTERN.CONTINUE_DOT.test(value)?msg="IAM.ERROR.USERNAME.CONSECUTIVE.DOTS":Validator.PATTERN.ENDS_ALPHA_NUMERIC.test(value)?Validator.PATTERN.ONLY_NUMERIC.test(value)&&(msg="IAM.ERROR.USERNAME.ATLEAST.ONEALPHA"):msg="IAM.ERROR.USERNAME.ENDSWITH":msg="IAM.ERROR.USERNAME.ONLY.ALPANUMERIC":msg="IAM.ERROR.USERNAME.STARTSWITH",this.settings?Validator.setJQueryMessage(this,msg,element):I18N.get(msg)},Validator.newPassword=function(value,element){var msg=null,f=element&&element.form||this.currentForm;return value=value.trim(),value.length<1?msg="IAM.ERROR.ENTER.LOGINPASS":value.length<userPasswordMinLen?msg="IAM.ERROR.PASS.LEN":value.length>userPasswordMaxLen?msg="IAM.ERROR.PASSWORD.MAXLEN":f&&f.username&&value.trim()==f.username.value.trim()&&(msg="IAM.PASSWORD.POLICY.LOGINNAME"),this.settings?Validator.setJQueryMessage(this,msg,element):I18N.get(msg)},Validator.addDefaultMethods=function(){$.validator&&($.validator.addMethod("portalname",Validator.newPortal),$.validator.addMethod("username",Validator.newUsername),$.validator.addMethod("password",Validator.newPassword),$.validator.addMethod("email",function(value,element){return Validator.isEmail(value)?!0:Validator.setJQueryMessage(this,"IAM.ERROR.EMAIL.INVALID",element)}),$.validator.addMethod("emailormobile",function(value,element){return Validator.isMobile(value)||Validator.isEmail(value)?!0:Validator.setJQueryMessage(this,"IAM.ERROR.EMAIL.OR.MOBILE.INVALID",element)}))},Validator.addDefaultMethods(),function($){$.fn.zaSignUp=function(options){var args=null;if(!options||"object"==typeof options){var formOptions=$.extend(!0,{},$.fn.zaSignUp.defaults,options);options&&options.oncomplete&&(formOptions.x_signup.oncomplete=formOptions.oncomplete,formOptions.oncomplete=null),args=[formOptions]}return this.form.apply(this,args||arguments)},$.fn.zaSignUp.SIGNUP_STATE={ERROR:0,ACCOUNT_CREATED:1,UPDATE_SERVICE_FIELDS:2,SIGNUP_COMPLETED:3},$.fn.zaSignUp.defaults={initError:function(errorCode,msg){"SIGNUP101"==errorCode&&(Form.Message.error(this.element,msg),this.element.find(":input").attr("disabled","true"))},oncomplete:function(){$(".loadingImg").hide()},getConfirmationTemplate:function(){$(".inner-container").css("display","none");var sb=new StringBuilder('<section class="za-confirm">');return sb.append('<div class="za-confirm-container">'),sb.append('<div class="za-confirm-title">').append(I18N.get("IAM.REGISTER.ACCOUNT.CONFIRMATION")).append("</div>"),sb.append('<p class="za-confirm-msg">').append(I18N.get("IAM.SIGNUP.CONFIRMATION.VERIFY.EMAIL")).append("</p>"),sb.append('<p class="za-confirm-note">').append(I18N.get("IAM.SIGNUP.CONFIRMATION.RIGHT.TO.DEACTIVATE")).append(I18N.get("IAM.EMAIL.TIP")).append("</p>"),sb.append('<div class="za-confirm-btn"><input type="button" class="signupbtn" value="').append(I18N.get("IAM.BUTTON.CONTINUE.SIGNIN")+"&#8594;").append('">'),sb.append("</div></div></section>"),sb.toString()},handleConfirmation:function(data){if(!$(".za-confirm").length){var confirmTpl=this.options.getConfirmationTemplate().replace("$EMAIL",data.email);$("body").append(confirmTpl)}$(".za-confirm").height($(document).height()).show().find("input").focus().click(data.doAction),setTimeout(function(){data.doAction()},5e3)},create:function(){var $f=this.element.attr("autocomplete","off"),options=this.options,signupOptions=options.x_signup,requestParams=Util.parseParameter(location.search);signupOptions.params=signupOptions.params||{},signupOptions.params.is_ajax=!0;for(var i=0,len=signupOptions.paramsNames.length;len>i;i++){var paramValue,paramName=signupOptions.paramsNames[i];!signupOptions.params[paramName]&&(paramValue=requestParams[paramName])&&(signupOptions.params[paramName]=paramValue)}$f.find("input[name='password'], input[name='repassword'], input[name='captcha']").data("secret","true"),$.each(["captcha","password","email","username","newsletter","emailormobile"],function(i,v){var $container=$f.find(".za-"+v+"-container"),isRequired=signupOptions[v+"_required"]===!0,isClientPortal=signupOptions.client_portal===!0;if((isRequired||"captcha"==v)&&!$container.find("input[name='"+v+"']").length){if("newsletter"===v&&isClientPortal)return;throw alert(I18N.get("IAM.ERROR.GENERAL")),'"'+v+'" field is not present'}toggleField($container,isRequired)}),signupOptions.allow_signup===!1&&options.initError.call(this,"SIGNUP101",I18N.get("IAM.ERROR.SIGNUP.NOT.ALLOWED"));var captchaDigest=signupOptions.captchaDigest;$f.each(function(idx,ele){reloadCaptcha(idx,ele,0==idx?captchaDigest:null)}),signupOptions.doZLocHandling?injectLocationForm(options):$(".za-region-container").css("display","none")},url:function(){return ZAConstants.getAbsoluteURL("/accounts/register.ac")},params:function(){return this.options.x_signup.params},crossdomain:!0,csrf:!1,success:signupResponse,error:function(jqXHR){Form.Message.error(this.element,I18N.get("IAM.ERROR.GENERAL")),this.options.x_signup.oncomplete&&this.options.x_signup.oncomplete.call(this,$.fn.zaSignUp.SIGNUP_STATE.ERROR,jqXHR)},validator:{rules:{captcha:"required",portalname:{portalname:!0,validateRemote:!0},username:{username:!0,validateRemote:!0},lastname:"required",password:"password",emailormobile:{emailormobile:!0,validateRemote:{params:function(){var signupParams=$(this.currentForm).zaSignUp("options").x_signup.params;return{portal:signupParams.portal}}}},email:{email:!0,validateRemote:{params:function(){var signupParams=$(this.currentForm).zaSignUp("options").x_signup.params;return{portal:signupParams.portal}}}},repassword:"confirmPassword"},messages:{captcha:{required:function(){return I18N.get("IAM.ERROR.WORD.IMAGE")}},lastname:{required:function(){return I18N.get("IAM.ERROR.LASTNAME.MANDATORY")}}},ignore:".ignore-validation"},passwordStrength:".za-password-container input",checkEmail:".za-email-container input",disableSubmit:function(){$(".loadingImg").show(),$("footer").hide(),$(".idpform").is(":visible")&&$(".idpform").hide()}},$.validator.addMethod("confirmPassword",function(value,element){return this.currentForm.password&&value.trim()!=this.currentForm.password.value.trim()?(this.settings.messages[element.name]=I18N.get("IAM.ERROR.WRONG.CONFIRMPASS"),!1):!0}),$.validator.addMethod("validateRemote",function(value,element,param){var validator=this,options=null,formOptions=$(validator.currentForm).zaSignUp("options"),signupOptions=formOptions.x_signup;if(0==element.name.indexOf(CrossServiceRequest.CONSTANTS.CUSTOM_FIELD)){var customFieldData=CrossServiceRequest.toJSON("za_signup",this.currentForm,{validate:element.name});customFieldData&&(options=CrossServiceRequest.getAjaxOptions(signupOptions.appName,"vfields"),options.data=$.zaParam({data:JSON.stringify(customFieldData)}))}else{var pdata=param&&Util.valueOf(param.params,validator)||{};options={url:ZAConstants.getAbsoluteURL("/accounts/validate/register.ac"),type:"POST",data:pdata},options.data[element.name]=$(element).val(),options.data.servicename=signupOptions.appName,options.data.m_redirect=signupOptions.m_redirect,signupOptions.params&&signupOptions.params.m_redirect&&(options.data.m_redirect=signupOptions.params.m_redirect),signupOptions.params&&signupOptions.params.stop_mredirect&&(options.data.stop_mredirect=signupOptions.params.stop_mredirect)}if(options){if(validator.optional(element))return"dependency-mismatch";var previous=validator.previousValue(element);return validator.settings.messages[element.name]||(validator.settings.messages[element.name]={}),previous.originalMessage=this.settings.messages[element.name].remote,validator.settings.messages[element.name].remote=previous.message,param="string"==typeof param&&{url:param}||param,validator.pending[element.name]?"pending":previous.old===value?previous.valid:(previous.old=value,validator.startRequest(element),CrossServiceRequest.send($.extend(!0,{url:param,mode:"abort",port:"validate"+element.name,dataType:"json",success:function(json){validator.settings.messages[element.name].validateRemote=previous.originalMessage;var valid=null==json.error;if(valid){var submitted=validator.formSubmitted;validator.prepareElement(element),validator.formSubmitted=submitted,validator.successList.push(element),validator.showErrors()}else{var errors=I18N.get(json.error);validator.settings.messages[element.name].validateRemote=previous.message=errors[element.name],validator.showErrors(errors),"x_"==element.name.slice(0,2)&&customFieldAudit(element.name,errors[element.name])}previous.valid=valid,validator.stopRequest(element,valid),param&&$.isFunction(param.success)&&param.success.call(validator,json,element)}},options),formOptions.usePostMessage),"pending")}return!0})}(jQuery);var FederatedSignIn={GO:function(idp){var zaOptionsParam=$.fn.zaSignUp.defaults,servicename=zaOptionsParam.x_signup.appName,serviceurl=zaOptionsParam.x_signup.redirectAppUrl,csrfparam=zaOptionsParam.x_signup.csrfParamName,csrfValue=zaOptionsParam.x_signup.csrfValue,fbRequestUrl=zaOptionsParam.x_signup.facebookUrl,googleRequestUrl=zaOptionsParam.x_signup.googleUrl,openidRequestUrl=zaOptionsParam.x_signup.openidUrl,signupParams=zaOptionsParam.x_signup.params,openidurl=FederatedSignIn.getOpenIdUrl(idp),newurl=ZAConstants.getAccountsServer(),oldurl=newurl,idpClass=$(".idpform").is(":visible"),openid_val="/openid";idpClass||(("g"==idp||"ga"==idp)&&(openid_val="/goauth"),FederatedSignIn.crete(oldurl+openid_val));var $f=$(document.idpform);$f.find(":input").remove(),signupParams.scopes&&$f.append('<input type="hidden" name="scopes" value="'+signupParams.scopes+'">'),signupParams.appname&&$f.append('<input type="hidden" name="appname" value="'+signupParams.appname+'">'),signupParams.getticket&&$f.append('<input type="hidden" name="getticket" value="'+signupParams.getticket+'">'),openidurl&&$f.append('<input type="hidden" name="identifier" value="'+openidurl+'">'),servicename&&$f.append('<input type="hidden" name="servicename" value="'+servicename+'">'),serviceurl&&$f.append('<input type="hidden" name="serviceurl" value="'+serviceurl+'">');var action=openidRequestUrl;"f"==idp?action=fbRequestUrl:"t"==idp?action="/accounts/fsrequest?provider=TWITTER":"l"==idp?action="/accounts/fsrequest?provider=LINKEDIN":("g"==idp||"ga"==idp)&&(action=googleRequestUrl),0===action.lastIndexOf("/accounts/fsrequest",0)&&csrfparam&&$f.append('<input type="hidden" name="'+csrfparam+'" value="'+csrfValue+'">'),$f.attr({action:oldurl+action,method:"post",novalidate:"true"}),"ga"===idp?($f.submit(validateGApp),$f.append('<input type="text" class="small-input gapptext" placeholder="'+I18N.get("IAM.SIGNIN.IDP.GAPPS.DOMAIN")+'" name="domain" autofocus/>'),$f.append('<input type="submit" class="signupbtn openidbtn" value="Submit">'),$(".gapptext").focus()):document.idpform.submit()},getOpenIdUrl:function(idpval){return"g"===idpval?"https://www.google.com/accounts/o8/id":"ga"===idpval?"https://www.google.com/accounts/o8/site-xrds?hd=":"y"===idpval?"https://me.yahoo.com/":"l"===idpval?"https://www.linkedin.com/secure/developer":"t"===idpval?"https://apps.twitter.com/":""},crete:function(url){var idp_form=document.createElement("form");idp_form.name="idpform",idp_form.method="post",idp_form.action=url,idp_form.className="idpform",$("body").append(idp_form)}};$("#newsletter").focusin(function(){$("#signup-newsletter").addClass("focus"),$(document).on("keydown.tabindex",function(e){return 9===e.keycode?($("#submitBtn").focus(),e.preventDefault(),!1):void 0})}).focusout(function(){$("#signup-newsletter").removeClass("focus"),$(document).off("keydown.tabindex")});function StringBuilder(_iv){var arr=_iv?[_iv]:[];this.append=function(v){return arr.push(v),this},this.toString=function(){return arr.join("")},this.isEmpty=function(){return this.length()<1},this.length=function(){return arr.length}}function getSubDomain(domain){for(var i=0,sdomain=domain,p=sdomain.split("."),s="_zagd"+(new Date).getTime();i<p.length-1&&-1==document.cookie.indexOf(s+"="+s);)sdomain=p.slice(-1-++i).join("."),document.cookie=s+"="+s+";domain="+sdomain+";";return document.cookie=s+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;domain="+sdomain+";",sdomain}function reloadCaptcha(idx,f,cdigest){if(f=f||idx,!f.captcha.disabled){var captchaCallback=function(cdigest){var $captcha=$(f).find(".za-captcha").attr("src",ZAConstants.getAbsoluteURL("/accounts/captcha?cdigest="+cdigest));f.cdigest||$("<input type='hidden' name='cdigest' value='"+cdigest+"'>").insertAfter($captcha),f.cdigest.value=cdigest,f.captcha.value="",f.captcha.autocomplete="off"};if(cdigest)captchaCallback(cdigest);else{var options={url:ZAConstants.getAbsoluteURL("/accounts/captcha"),type:"post",data:{action:"newcaptcha"},success:captchaCallback};window.CrossServiceRequest?CrossServiceRequest.send(options,!0):$.ajax(options)}}}function toggleField($container,show){show?$container.show().find(":input").removeAttr("disabled"):$container.hide().find(":input").attr("disabled","true")}function AjaxResponse(json){"string"==typeof json&&(json=$.parseJSON(json)),this.json=json,this.type=json[AjaxResponse.FIELDS.TYPE],this.error=json[AjaxResponse.FIELDS.ERROR],this.data=json[AjaxResponse.FIELDS.DATA]}function Form($form,options){var _this=this;if(_this.element=$form,_this.options=options=$.extend(!0,{},$.fn.form.defaults,options),_this._normalizeOptions(),_this.element.attr({action:options.url,method:options.method}),_this._initHints(),options.validator&&(this.validator=this.element.validate(options.validator)),options.passwordStrength){var pwdlen="";options.x_signup&&options.x_signup.minpwdlen&&(pwdlen=options.x_signup.minpwdlen),Form.PasswordStrength.init(options.passwordStrength,_this.element,pwdlen)}options.checkEmail&&Form.checkEmailDomain.init(options.checkEmail,_this.element,options.x_signup.domains,options.x_signup.isEmailCheck),_this.element.submit(function(event){_this.submit(event)}),options.create&&options.create.call(this),$.fn.zPlaceHolder&&options.zplaceholder_fallback&&_this.element.find("input[placeholder]").zPlaceHolder()}function signupResponse(json,textStatus,jqXHR){try{var jr=JSON.parse(json);if(jr&&"success"==jr.status)return void(window.parent.location.href=jr.redirecturl)}catch(e){}var ar=new AjaxResponse(json);if(ar.error){var f=this.element.get(0);return Form.Message.error(this.element,ar.error.msg),reloadCaptcha(f),!1}var data=ar.data,_this=this,statusCode=data.httpResponseCode,isSuccess=statusCode>=200&&300>statusCode,representation=data.representation[0],f=_this.element.get(0),$f=$(f),signupOptions=_this.options.x_signup;if(isSuccess){signupOptions.oncomplete&&signupOptions.oncomplete.call(_this,$.fn.zaSignUp.SIGNUP_STATE.ACCOUNT_CREATED,jqXHR);var customFieldData=CrossServiceRequest.toJSON("za_signup",f);if(customFieldData){var url=representation.redirect_uri,qs=representation.token_params,idx=url.indexOf(qs),params="data="+Util.euc(JSON.stringify(customFieldData));if(representation.oauthorize_uri){var options={url:representation.oauthorize_uri,type:"post",data:{is_ajax:!0}};CrossServiceRequest.send(options,_this.options.usePostMessage);var ouri=representation.oauthorize_uri,stateParam="state=",allParams=ouri.slice(ouri.indexOf(stateParam)+stateParam.length);url=decodeURIComponent(allParams.slice(0,allParams.indexOf("&")))}else params+=qs?"&"+qs:"";return CrossServiceRequest.sendToApp(signupOptions.appName,"ufields",params,{complete:function(){if(signupOptions.oncomplete&&signupOptions.oncomplete.call(_this,$.fn.zaSignUp.SIGNUP_STATE.UPDATE_SERVICE_FIELDS,jqXHR),-1!=idx){var tmpqs=(-1!=url.indexOf("?"+qs)?"?":"&")+qs;url=url.replace(tmpqs,"")}representation.redirect_uri=url,signupSucceed(_this,representation)}},_this.options.usePostMessage)}signupSucceed(_this,representation)}else{if("400"==data.httpResponseCode&&representation.redirect_uri)window.location.href=representation.redirect_uri;else if(data.errorCode){var errorObj={},errorCode=data.errorCode;if("A110"==errorCode)errorObj.captcha=I18N.get("IAM.ERROR.INVALID_IMAGE_TEXT");else if("U101"==errorCode)data.errorCause.indexOf("Invalid Mobile Number")>0?errorObj.emailormobile=I18N.get("IAM.MOBILE.ENTER.INVALID.MOBILE"):errorObj.username=data.localizedMessage;else if("U102"==errorCode)errorObj.email=data.localizedMessage;else if("U103"==errorCode)errorObj.password=data.localizedMessage;else if("PP101"===errorCode)errorObj.password=data.localizedMessage;else if("PP106"===errorCode)errorObj.password=data.localizedMessage;else if("Z114"==errorCode)errorObj.emailormobile=I18N.get("IAM.ERROR.PHONENUMBER.MOBILE.ALREADY.EXISTS");else if("Z102"==errorCode)"useremail"==data.errorResource||"emaild"==data.errorResource?errorObj.email=I18N.get("IAM.ERROR.EMAIL.EXISTS"):"username"==data.errorResource||"screenname"==data.errorResource?errorObj.username=I18N.get("IAM.ERROR.USERNAME.NOT.AVAILABLE"):errorObj.portal=I18N.get("IAM.ERROR.PORTAL.EXISTS");else if("INPUT_ERROR_102"==errorCode){if(data.errorColumn)for(var i in data.errorColumn){var column=data.errorColumn[i],field=f[column]||f[CrossServiceRequest.CONSTANTS.RESOURCE_FIELD+column];field&&(errorObj[field.name]=I18N.get("IAM.ERROR.VALID.VALUE"))}}else errorObj="Z112"==errorCode?I18N.get("IAM.ERROR.DIFFERENT.REGION",data.errorResource):data.localizedMessage||I18N.get("IAM.ERROR.GENERAL");"string"==typeof errorObj?Form.Message.error($f,errorObj):($.each(["captcha","password","email","username"],function(i,v){errorObj[v]&&f[v]&&f[v].disabled&&toggleField($f.find(".za-"+v+"-container"),!0)}),_this.showErrors(errorObj))}else Form.Message.error($f,I18N.get("IAM.ERROR.GENERAL"));reloadCaptcha(f),signupOptions.oncomplete&&signupOptions.oncomplete.call(_this,$.fn.zaSignUp.SIGNUP_STATE.ERROR,jqXHR)}}function signupSucceed(signup,representation){if(signup.options.x_signup.oncomplete&&signup.options.x_signup.oncomplete.call(signup,$.fn.zaSignUp.SIGNUP_STATE.SIGNUP_COMPLETED),!representation.email)return void(window.location.href=representation.redirect_uri);var doActionCalled=!1;signup.options.handleConfirmation.call(signup,{email:representation.email,doAction:function(){doActionCalled||(doActionCalled=!0,window.location.href=representation.redirect_uri)}})}function customFieldAudit(field,error){$.post(ZAConstants.getAbsoluteURL("/accounts/regaudit/customfield"),{field:field,error:error})}function showPassword(t){var passwordEle=$(".form .za-password-container input")[0];"password"==passwordEle.type?($(t).html(I18N.get("IAM.PASSWORD.HIDE")),passwordEle.type="text",passwordEle._zhide_timeout_=setTimeout(function(){showPassword(t)},5e3)):(clearTimeout(passwordEle._zhide_timeout_),$(t).html(I18N.get("IAM.PASSWORD.SHOW")),passwordEle.type="password")}function validateGApp(e){var val=this.domain.value;(!val||val.length<1)&&(Util.stopEvents(e),Form.Message.error(this,I18N.get("IAM.ERROR.IDP.VALID.DOMAIN")))}function togglePasswordField(pl){var password=$("#password"),type="",showpasswordicon=$("#show-password-icon");showpasswordicon.hasClass("uncheckedpass")?(type="text",showpasswordicon.removeClass("uncheckedpass").addClass("checkedpass")):(type="password",showpasswordicon.removeClass("checkedpass").addClass("uncheckedpass"));var input=$("<input>").val(password.val()).attr({id:"password",tabindex:"1",autocomplete:"off",type:type,placeholder:I18N.get("IAM.PASSWORD"),"class":password.attr("class"),name:"password",spellcheck:"false",onkeyup:"checkPasswordStrength("+pl+")",onfocus:"hideMsg(this);showPwdMsg()",onblur:"hideLenError(this,"+pl+")"});password.before(input),selectTextEnd(input[0],input.val().length),password.remove(),input.focus()}function toggleNewsletterField(){var showpasswordicon=$("#signup-newsletter");showpasswordicon.hasClass("unchecked")?(showpasswordicon.removeClass("unchecked").addClass("checked"),$("#newsletter").val(!0)):(showpasswordicon.removeClass("checked").addClass("unchecked"),$("#newsletter").val(!1))}function selectTextEnd(input,inputLen){if(input.setSelectionRange)input.setSelectionRange(inputLen,inputLen);else if(input.createTextRange){var range=input.createTextRange();range.collapse(!0),range.moveStart("character",inputLen),range.moveEnd("character",inputLen),range.select()}}function checkPasswordStrength(pl){$(".show-password").show(),$(".password-strength div").hide();var p_word=$("#password").val(),len=p_word.length,score=Form.PasswordStrength.getScore("",p_word),status=pl>=len?"weak":Form.PasswordStrength.getStatus(score);$("#pwdstrength").removeClass();var bgColor="weak"===status?"#D21C2B":"good"===status||"fair"===status?"#2489d0":"strong"===status?"#21b100":"#D21C2B";$(".pwdtext").css("color",bgColor),len>=pl?($(".pwderror").hide(),$(".pwdparent").css("marginTop","-7px"),$(".pwdparent").css("marginBottom","18px")):pl>len&&($(".pwderror").show(),$(".pwdparent").css("marginTop","0"),$(".pwdparent").css("marginBottom","0")),len>=pl&&"weak"===status?($(".pwdtext").html(I18N.get("fair"===status?"":"")),$("#pwdstrength").addClass("weak")):"fair"===status||"good"===status?($(".pwdtext").html(I18N.get("")),$("#pwdstrength").addClass("good")):"strong"===status?($(".pwdtext").html(I18N.get("")),$("#pwdstrength").addClass("strong")):$(".pwdtext").html("")}function hideMsg(t){Form.Message.hideError(t),$(".za-email-suggestion").is(":visible")&&$(".za-email-suggestion").remove()}function hideLenError(t,n){Form.Message.hideError(t);var p_word=$("#password").val(),len=p_word.length;len>=1&&n>len&&($("#errormg").removeClass("pwderror"),$("#errormg").addClass("dummyerror"),Form.Message.create($(t),"error","").addClass("jqval-error"),$("#password").addClass("temperror"))}function showPwdMsg(){$("#errormg").removeClass("dummyerror"),$("#errormg").addClass("pwderror"),$(".captchaCnt").css("marginTop","0"),$("#password").removeClass("temperror"),$("#errormg").is(":visible")||($("#errormg").slideDown(100),$(".za-newsletter-container label").css("marginTop","2px"))}function injectLocationForm(options){if(isEu(options)){var select=document.createElement("select");select.classList.add("za-region-select"),select.classList.add("ignore-validation"),select.dclpfxcookiename=options.x_signup.dclCookieName,$(select).css("width","115px");var depMap=options.x_signup.zLocations;for(var dep in depMap){var option=document.createElement("option");option.value=depMap[dep].url,option.text=dep,option.code=depMap[dep].code,options.x_signup.zCurLoc==dep&&(option.selected="selected"),select.add(option)}select.onchange=function(e){var form=$(".form"),selectedOption=this.getElementsByTagName("option")[this.selectedIndex];setCookie(this.dclpfxcookiename,selectedOption.code);var acc_url=e.target.value;form.zaSignUp("options").ajax.url=acc_url+"/accounts/register.ac",form.zaSignUp("options").url=acc_url+"/accounts/register.ac",ZAConstants.setAccountsServer(acc_url),form.validate().resetForm()},$(".za-region-container").length>0?$(".za-region-container").append(select):$(".form").prepend(select)}else $(".za-region-container").css("display","none")}function setCookie(name,value){var host=document.location.host;host=host.substring(host.indexOf("."));var cookieStr=name+"="+value+";Path=/;";cookieStr+="domain="+host,document.cookie=cookieStr}function isEu(options){var date=new Date;if(date.getTimezoneOffset()<=0&&date.getTimezoneOffset()>=-180){var euTZ=["(CEST)","(WEST)","(WET)","(EET)","(WEST)","(EEST)","(CET)"],thisTZ=date.toString().toUpperCase();for(var i in euTZ)if(thisTZ.indexOf(euTZ[i])>-1)return!0}return options.x_signup.isEU||!1}function checkmblbox(id){var check=de(id);check.checked?($("#checkbx").removeClass("checkedBox"),$("#checkbx").addClass("uncheckBox")):($("#checkbx").removeClass("uncheckBox"),$("#checkbx").addClass("checkedBox"))}var PasswordStrength=function(){var MULTIPLE_NUMBERS_RE=/\d.*?\d.*?\d/,MULTIPLE_SYMBOLS_RE=/[!@#$%^&*?_~].*?[!@#$%^&*?_~]/,UPPERCASE_LOWERCASE_RE=/([a-z].*[A-Z])|([A-Z].*[a-z])/,SYMBOL_RE=/[!@#\$%^&*?_~]/;this.username=null,this.password=null,this.score=0,this.status=null,this.test=function(){return this.score=0,this.containInvalidMatches()?this.status="invalid":(this.score+=this.scoreFor("password_size"),this.score+=this.scoreFor("numbers"),this.score+=this.scoreFor("symbols"),this.score+=this.scoreFor("uppercase_lowercase"),this.score+=this.scoreFor("numbers_chars"),this.score+=this.scoreFor("numbers_symbols"),this.score+=this.scoreFor("symbols_chars"),this.score+=this.scoreFor("only_chars"),this.score+=this.scoreFor("only_numbers"),this.score+=this.scoreFor("username"),this.score+=this.scoreFor("sequences"),this.score+=this.scoreFor("repetitions"),this.score<0&&(this.score=0),this.score>100&&(this.score=100),this.score<35&&(this.status="weak"),this.score>=35&&this.score<70&&(this.status="good"),this.score>=70&&(this.status="strong")),this.score},this.scoreFor=function(name){switch(score=0,name){case"password_size":score=this.password.length<4?-100:4*this.password.length;break;case"numbers":this.password.match(MULTIPLE_NUMBERS_RE)&&(score=5);break;case"symbols":this.password.match(MULTIPLE_SYMBOLS_RE)&&(score=5);break;case"uppercase_lowercase":this.password.match(UPPERCASE_LOWERCASE_RE)&&(score=10);break;case"numbers_chars":this.password.match(/[a-z]/i)&&this.password.match(/[0-9]/)&&(score=15);break;case"numbers_symbols":this.password.match(/[0-9]/)&&this.password.match(SYMBOL_RE)&&(score=15);break;case"symbols_chars":this.password.match(/[a-z]/i)&&this.password.match(SYMBOL_RE)&&(score=15);break;case"only_chars":this.password.match(/^[a-z]+$/i)&&(score=-15);break;case"only_numbers":this.password.match(/^\d+$/i)&&(score=-15);break;case"username":this.password==this.username?score=-100:-1!=this.password.indexOf(this.username)&&(score=-15);break;case"sequences":score+=-15*this.sequences(this.password),score+=-15*this.sequences(this.reversed(this.password));break;case"repetitions":score+=-(4*this.repetitions(this.password,2)),score+=-(3*this.repetitions(this.password,3)),score+=-(2*this.repetitions(this.password,4))}return score},this.isGood=function(){return"good"==this.status},this.isWeak=function(){return"weak"==this.status},this.isStrong=function(){return"strong"==this.status},this.isInvalid=function(){return"invalid"==this.status},this.isValid=function(level){return"strong"==level?this.isStrong():"good"==level?this.isStrong()||this.isGood():!this.containInvalidMatches()},this.containInvalidMatches=function(){return this.exclude&&this.exclude.test?this.exclude.test(this.password.toString()):!1},this.sequences=function(text){for(var previousCode,currentCode,matches=0,sequenceSize=0,codes=[],len=text.length,i=0;len>i;i++)currentCode=text.charCodeAt(i),previousCode=codes[codes.length-1],codes.push(currentCode),previousCode&&(currentCode==previousCode+1||previousCode==currentCode?sequenceSize+=1:sequenceSize=0),2==sequenceSize&&(matches+=1);return matches},this.repetitions=function(text,size){for(var substring,occurrences,tmpText,count=0,matches={},len=text.length,i=0;len>i;i++)if(substring=text.substr(i,size),occurrences=0,tmpText=text,!(matches[substring]||substring.length<size)){for(matches[substring]=!0;-1!=(i=tmpText.indexOf(substring));)occurrences+=1,tmpText=tmpText.substr(i+1);occurrences>1&&(count+=1)}return count},this.reversed=function(text){for(var newText="",len=text.length,i=len-1;i>=0;i--)newText+=text.charAt(i);return newText}};PasswordStrength.test=function(username,password){return strength=new PasswordStrength,strength.username=username,strength.password=password,strength.test(),strength},function(b){b.fn.mailcheck=function(a,b){var d="yahoo.com,google.com,hotmail.com,gmail.com,me.com,aol.com,mac.com,live.com,comcast.net,googlemail.com,msn.com,hotmail.co.uk,yahoo.co.uk,facebook.com,verizon.net,sbcglobal.net,att.net,gmx.com,mail.com".split(","),e="co.uk,com,net,org,info,edu,gov,mil".split(",");if("object"==typeof a&&void 0===b)a.domains=a.domains||d;else{var g=a,a=b;a.domains=g||d}a.topLevelDomains=a.topLevelDomains||e,a.distanceFunction=Kicksend.sift3Distance,(d=Kicksend.mailcheck.suggest(encodeURI(this.val()),a.domains,a.topLevelDomains,a.distanceFunction))?a.suggested&&a.suggested(this,d):a.empty&&a.empty(this)}}(jQuery);var Kicksend={mailcheck:{threshold:3,suggest:function(b,a,c,d){if(b=b.toLowerCase(),b=this.splitEmail(b),a=this.findClosestDomain(b.domain,a,d)){if(a!=b.domain)return{address:b.address,domain:a,full:b.address+"@"+a}}else if(c=this.findClosestDomain(b.topLevelDomain,c),b.domain&&c&&c!=b.topLevelDomain)return a=b.domain,a=a.substring(0,a.lastIndexOf(b.topLevelDomain))+c,{address:b.address,domain:a,full:b.address+"@"+a};return!1},findClosestDomain:function(b,a,c){var d,e=99,g=null;if(!b||!a)return!1;c||(c=this.sift3Distance);for(var f=0;f<a.length;f++){if(b===a[f])return b;d=c(b,a[f]),e>d&&(e=d,g=a[f])}return e<=this.threshold&&null!==g?g:!1},sift3Distance:function(b,a){if(null==b||0===b.length)return null==a||0===a.length?0:a.length;if(null==a||0===a.length)return b.length;for(var c=0,d=0,e=0,g=0;c+d<b.length&&c+e<a.length;){if(b.charAt(c+d)==a.charAt(c+e))g++;else for(var f=e=d=0;5>f;f++){if(c+f<b.length&&b.charAt(c+f)==a.charAt(c)){d=f;break}if(c+f<a.length&&b.charAt(c)==a.charAt(c+f)){e=f;break}}c++}return(b.length+a.length)/2-g},splitEmail:function(b){if(b=b.split("@"),2>b.length)return!1;for(var a=0;a<b.length;a++)if(""===b[a])return!1;var c=b.pop(),d=c.split("."),e="";if(0==d.length)return!1;if(1==d.length)e=d[0];else{for(a=1;a<d.length;a++)e+=d[a]+".";2<=d.length&&(e=e.substring(0,e.length-1))}return{topLevelDomain:e,domain:c,address:b.join("@")}}}},ZAConstants={csrfParam:null,csrfCookie:null,contextpath:"/accounts",load:function(json){this.config=json,$.each("accountsServer,csrfParam,csrfCookie,js_url,css_url,img_url".split(","),function(i,key){var v=json[key];v&&(ZAConstants[key]=v)})},setAccountsServer:function(serverURL){if(-1==serverURL.indexOf("://"))throw"Invalid Protocol given for the URL : "+serverURL;this.accountsServer=serverURL,this.schemeLessAccountsServer=null},getAccountsServer:function(){return!this.schemeLessAccountsServer&&this.accountsServer&&(this.schemeLessAccountsServer=this.accountsServer.substring(this.accountsServer.indexOf("://")+1)),this.schemeLessAccountsServer},getAbsoluteURL:function(path){return this.getAccountsServer()+path}};$.isFunction(String.prototype.trim)||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});var _xxxHTTP="http__://".replace("__",""),_xxxHTTPS="https__://".replace("__","");!function($){function processField(idx,input){var $input=$(input),placeholder=$input.attr("placeholder");$input.attr("title")||$input.attr("title",placeholder);var $overlay=$("<span />").addClass("zph-overlay").html(placeholder).css("font-size",$(input).css("font-size"));$input.removeAttr("placeholder").keydown(toggleClass).parent().addClass("zph-placeholder").prepend($overlay),$overlay.click(function(){$input.focus()}),toggleClass(null,$input)}function toggleClass(e,t){var $input=$(t||this);setTimeout(function(){var value=$input.val();0==value?$input.parent().removeClass("zph-hide").addClass("zph-show"):$input.parent().removeClass("zph-show").addClass("zph-hide")},0)}$.support.zplaceholder="placeholder"in document.createElement("input"),$.fn.zPlaceHolder=function(){(!$.support.zplaceholder||$.browser&&$.browser.msie&&!(parseInt($.browser.version)<10))&&this.each(processField)}}(jQuery);var Cookie={add:function(cn,cv,domain,maxage,secure){document.cookie=cn+"="+escape(cv)+";path=/"+(domain?";domain="+domain:"")+(maxage?";max-age="+maxage:"")+(secure?";secure="+secure:"")},get:function(cn){if(document.cookie.length>0){var beginIdx=document.cookie.indexOf(cn+"=");if(-1!=beginIdx){beginIdx=beginIdx+cn.length+1;var endIdx=document.cookie.indexOf(";",beginIdx);return-1==endIdx&&(endIdx=document.cookie.length),unescape(document.cookie.substring(beginIdx,endIdx))}}return""},append:function(cn,cv,domain,separator,maxage,secure){var oldcv=Cookie.get(cn),newcv="";newcv=oldcv?oldcv+separator+cv:cv,Cookie.add(cn,newcv,domain,maxage,secure)},remove:function(cn){document.cookie=cn+"=remove;path=/;max-age=0"}},I18N={data:{},load:function(arr){return $.extend(this.data,arr),this},get:function(key,args){if("object"==typeof key){for(var i in key)key[i]=I18N.get(key[i]);return key}var msg=this.data[key]||key;return args?(arguments[0]=msg,Util.format.apply(this,arguments)):msg}},Util={euc:function(value){return encodeURIComponent(value)},duc:function(value){return decodeURIComponent(value)},paramConfigure:function(args){var params=Util.parseParameter(location.search);$("html").hide(),$(document).ready(function(){$.each(params,function(pname,pvalue){pvalue="true"===pvalue;var value=args[pname];"string"==typeof value?$(value)[pvalue?"show":"hide"]():pvalue&&"object"==typeof value?$.each(value,function(selector,attrObj){$(selector).attr(attrObj)}):pvalue&&"function"==typeof value&&args[pname]()})}),$("html").show()},getCSRFValue:function(){return ZAConstants.csrfParam+"="+Util.euc(Cookie.get(ZAConstants.csrfCookie))},addCSRFParam:function(arr){return arr=arr||{},arr[ZAConstants.csrfParam]=Cookie.get(ZAConstants.csrfCookie),arr},parseParameter:function(qs){var paramArr={};if(-1==qs.indexOf("="))return paramArr;"?"==qs.charAt(0)&&(qs=qs.substring(1));for(var params=qs.split("&"),i=0;i<params.length;i++){var pArr=params[i].split("="),pN=decodeURIComponent(pArr[0]),pV=decodeURIComponent(pArr[1]),pOldV=paramArr[pN];pOldV?$.isArray(pOldV)?pOldV.push(pV):paramArr[pN]=[pOldV,pV]:paramArr[pN]=pV}return paramArr},serializeParams:function(obj){var sb=new StringBuilder;for(var k in obj){var v=obj[k];if(v)if(sb.isEmpty()||sb.append("&"),$.isArray(v))for(var first=!0,j=0;j<v.length;j++)first||sb.append("&"),sb.append(Util.euc(k)).append("=").append(Util.euc(v[j])),first=!1;else sb.append(Util.euc(k)).append("=").append(Util.euc(v))}return sb.toString()},stopEvents:function(e){e.stopPropagation?(e.preventDefault(),e.stopPropagation()):(e.cancelBubble=!0,e.returnValue=!1)},includeJSON2:function(){var json=window.JSON;if(!$.isFunction(json&&json.parse&&json.stringify)){var e=document.createElement("script");e.src=ZAConstants.js_url+"/js/tplibs/json2.js",e.type="text/javascript",document.body.appendChild(e)}},redirectToHTTPS:function(){var https=new StringBuilder("h").append("ttps://"),url=window.location.href;if(0!=url.indexOf(https)){var http=new StringBuilder("h").append("ttp://"),port=window.location.port;(0==port.length||"80"==port||"8080"==port)&&(window.location.href=url.replace(http,https).replace("8080","8443"))}},format:function(msg){if(msg)for(var i=1;i<arguments.length;i++)msg=msg.replace(new RegExp("\\{"+(i-1)+"\\}","g"),arguments[i]);return msg},updateOrigin:function(d){var domain=d||location.hostname,subdomain=getSubDomain(domain);return document.domain!==subdomain?(document.domain=subdomain,subdomain):void 0},valueOf:function(value,context){return $.isFunction(value)?value.call(context||this):value},getServerURL:function(url){if(0===url.indexOf("//")&&(url=window.location.protocol+url),0!==url.indexOf(_xxxHTTP)&&0!==url.indexOf(_xxxHTTPS))return null;var idx=url.indexOf("/",8);return-1===idx?url:url.substring(0,idx)}};AjaxResponse.FIELDS={TYPE:"t",ERROR:"error",DATA:"data"};var CrossServiceRequest={CONSTANTS:{RESOURCE_FIELD:"r_",CUSTOM_FIELD:"x_"},appURLs:{},currentForm:null,corsOptions:{type:"POST",crossDomain:!0,xhrFields:{withCredentials:!0}},postMessageOptions:{data:{_pmsg:!0}},jsSameOriginOptions:{data:{_corsfn:"CrossServiceRequest.handleFrameCallback"}},send:function(url,_options,usePostMessage){var options=options||{};if("object"==$.type(url)?(usePostMessage=_options,options=url):$.isFunction(options)?options={url:url,success:options}:(options.url=url,usePostMessage=options),0!=options.url.indexOf("http")&&0!=options.url.indexOf("//")&&(options.url=ZAConstants.getAbsoluteURL(options.url)),$.support.cors&&!usePostMessage)options=$.extend(!0,{},options,this.corsOptions),$.ajax(options);else{usePostMessage=usePostMessage&&!!window.postMessage;var iframeOptions=usePostMessage?this.postMessageOptions:this.jsSameOriginOptions,isDataInString=options.data&&"string"==$.type(options.data);if(isDataInString){var actualData=options.data;options=$.extend(!0,{},options,iframeOptions),options.data=actualData+"&"+$.zaParam(iframeOptions.data)}else options=$.extend(!0,{},options,iframeOptions);this.currentIFrame=CrossServiceRequest.insertCORSFrame();var $form=$("<form></form>",{action:options.url,method:"POST",autocomplete:"off",target:"corsFrame"});$.each(isDataInString?options.data.split("&"):options.data,function(k,v,i){if(isDataInString){i=k;var vArr=v.split("=");k=Util.duc(vArr[0]),v=Util.duc(vArr[1])}$("<input>",{type:"hidden",name:k,value:v}).appendTo($form)}),this.currentForm=$form.appendTo(document.body).data("__cors_options__",options),usePostMessage?$(window).one("message",{requestURL:options.url},CrossServiceRequest.handleReceiveMessage):Util.updateOrigin(),this.currentForm.submit()}},insertCORSFrame:function(){var $frame=$("iframe[name='corsFrame']");return $frame.length||($frame=$('<iframe src="'+ZAConstants.img_url+'/images/spacer.gif" name="corsFrame" frameborder="0" scrolling="no" style="display:none;border: none;margin: 0;width: 0;"></iframe>').appendTo(document.body)),$frame},handleResponse:function(data){var options=CrossServiceRequest.currentForm.data("__cors_options__");CrossServiceRequest.currentForm.remove(),CrossServiceRequest.currentForm=null,options.complete&&options.complete.call(options.context||this,data),options.success&&options.success.call(options.context||this,data)},handleFrameCallback:function(data){CrossServiceRequest.handleResponse(data)},handleReceiveMessage:function(_ev){var ev=_ev.originalEvent;if(!ev.origin||Util.getServerURL(_ev.data.requestURL)!==ev.origin)throw new Error("Message recevied from invalid origin. Origin : "+ev.origin+", Expected : "+_ev.data.requestURL);if(!ev.source||ev.source!==CrossServiceRequest.currentIFrame.get(0).contentWindow)throw new Error("Message recevied from invalid source");var data;try{data=$.parseJSON(ev.data)}catch(e){data=ev.data}CrossServiceRequest.handleResponse(data)},toJSON:function(screen,f,extraParams){for(var params={},hasCustomParam=!1,fields=$(f).serializeArray(),i=0;i<fields.length;i++){var field=fields[i],name=field.name;hasCustomParam||0!=name.indexOf(CrossServiceRequest.CONSTANTS.CUSTOM_FIELD)||(hasCustomParam=!0),"true"!=$(f[name]).data("secret")&&(params[name]=field.value)}return hasCustomParam?{v1:$.extend(!0,{screen:screen,params:params},extraParams)}:null},getAjaxOptions:function(appName,method,data,callback){var url=this.appURLs[appName]+"/~za~/"+appName+"/"+method,options={url:url,data:data,type:"POST",dataType:"json"};return $.isFunction(callback)?options.success=callback:callback&&$.extend(!0,options,callback),options},sendToApp:function(appName,method,data,callback,usePostMessage){var options=this.getAjaxOptions(appName,method,data,callback);return CrossServiceRequest.send(options,usePostMessage)}},__za_r20=/\+/g;$.zaParam=function(obj){var str=$.param(obj);return str?str.replace(__za_r20,"%20"):str},$.fn.zaSerialize=function(){return $.zaParam(this.serializeArray())},$.fn.form=function(options){if(!this.length)return this;var f=this.data("__form_obj__");if(f){if("string"==typeof options&&"_"!==options.charAt(0)){var value=f[options];if($.isFunction(f[options]))return value.apply(f,Array.prototype.slice.apply(arguments).splice(1));if(void 0!==value)return value}}else f=new Form(this,options),this.data("__form_obj__",f);return this},$.fn.form.defaults={create:null,url:null,method:"post",params:null,handleParams:null,crossdomain:!1,usePostMessage:!1,csrf:!0,commonerror:!1,success:null,error:null,ajax:{},validator:{},onsubmit:null,oncomplete:null,passwordStrength:null,hints:null,animateError:!0,submitButton:":submit",disableSubmit:!0,zplaceholder_fallback:!0},$.fn.form.validatorOptions={debug:!0,errorElement:"span",onsubmit:!1,onkeyup:function(element){var validator=this,timeoutKey=element.name+"_timeout";validator.za||(validator.za={}),clearTimeout(validator.za[timeoutKey]),validator.za[timeoutKey]=setTimeout(function(){(element.name in validator.submitted||""!=$(element).val())&&validator.element(element)},validator.settings.onkeyupdelay||500)},showErrors:function(errorMap){var $form=$(this.currentForm),options=$form.zaSignUp("options");options.commonerror?$.isEmptyObject(errorMap)?$form.zaSignUp("hideErrors",$form):$form.zaSignUp("showErrors",errorMap):this.defaultShowErrors()},errorPlacement:function(error,$input){Form.Message.create($input,"error",error).addClass("jqval-error")},highlight:function(input){Form.Message.error(input)},unhighlight:function(input){Form.Message.hideError(input)},success:function($error){Form.Message.valid($error.parent().parent())}},Form.prototype._normalizeOptions=function(){var _this=this,options=_this.options;if(options.url=_this._val(options.url)||_this.element.attr("action"),options.method=options.method||_this.element.attr("method"),$.isEmptyObject(options.validator))options.validator=null;else{var oldKeyUp=options.validator.onkeyup;options.validator=$.extend(!0,{},$.fn.form.validatorOptions,options.validator),options.validator.onkeyup=oldKeyUp===!0?$.fn.form.validatorOptions.onkeyup:oldKeyUp||!1}options.ajax=$.extend(!0,{url:options.url,type:options.method,context:_this,complete:_this._complete,success:options.success,error:options.error},options.ajax)},Form.prototype._val=function(value){return $.isFunction(value)?value.call(this):value},Form.prototype._initHints=function(){var _this=this,hints=_this.options.hints;for(var k in hints){var formEle=_this.element[0][k],$input=formEle&&formEle.nodeType===Node.ELEMENT_NODE?$(formEle):_this.element.find(k);Form.Message.element($input,"note").html(_this._val(hints[k]))}return this},Form.prototype._complete=function(jqXHR,textStatus){var _this=this,options=this.options;_this.updateSubmitState(!1),options.oncomplete&&options.oncomplete.call(this,jqXHR,textStatus)},Form.prototype.validate=function(){return this.validator?this.element.valid():!0},Form.prototype.showErrors=function(errorObj){if(this.options.commonerror)for(var i in errorObj)return Form.Message.error(this.element,errorObj[i]),!1;if(this.validator)this.validator.showErrors(errorObj),this.validator.focusInvalid();else{Form.Message.errors(this.element,errorObj);var f=this.element.get(0);for(var i in errorObj)if(f[i]){f[i].focus();break}}},Form.prototype.hideErrors=function(fields){Form.Message.hideErrors(this.element,fields)},Form.prototype.submit=function(event){Util.stopEvents(event);var _this=this,options=_this.options,$errorFields=options.animateError&&_this.element.find(".field-error");if(Form.Message.hideError(_this.element),!_this.validate())return _this.validator.focusInvalid(),options.animateError&&$errorFields.size()==_this.element.find(".field-error").size()&&$errorFields.fadeOut(function(){$(this).fadeIn()}),!1;if(_this.validator&&_this.validator.pendingRequest)return void(_this.validator.formSubmitted=!0);var params=null;if(options.handleParams)params=options.handleParams.call(this);else if(params=_this.element.zaSerialize(),options.csrf&&"post"==options.method&&(params+="&"+Util.getCSRFValue()),options.params){var optParams=this._val(options.params);params+="&"+("object"==typeof optParams?Util.serializeParams(optParams):optParams)}var ajaxOptions=$.extend(!0,{data:params},options.ajax),onSubmitValue=options.onsubmit&&options.onsubmit.call(this,ajaxOptions);return onSubmitValue===!1?!1:(_this.updateSubmitState(!0),void(options.crossdomain===!0?CrossServiceRequest.send(ajaxOptions,options.usePostMessage):$.ajax(ajaxOptions)))},Form.prototype.updateSubmitState=function(disable){var options=this.options;if(options.submitButton&&options.disableSubmit){var $btn=this.element.find(options.submitButton),disableValue=this._val(options.disableSubmit);disable?($btn.attr("disabled","true").addClass("disable-btn"),"string"==typeof disableValue&&$btn.data("za_form_original_value",$btn.val()).val(disableValue)):($btn.removeAttr("disabled").removeClass("disable-btn"),"string"==typeof disableValue&&$btn.val($btn.data("za_form_original_value")||$btn.val()))}},Form.Message={valid:function(selector){var $input=$(selector);return this.isForm($input)?this.element($input,"error").hide():$input.parent().addClass("field-valid"),$input},errors:function($f,obj){for(var k in obj)this.error($f.find("[name='"+k+"']"),obj[k])},hideErrors:function($f,fields){for(var i=0;i<fields.length;i++){var v=fields[i];this.hideError("string"==typeof v?$f.find("[name='"+v+"']"):v)}},error:function(selector,msg){var $input=$(selector);return msg&&this.element($input,"error").html(msg),this.isForm($input)?this.element($input,"error").css("display","block"):$input.parent().addClass("field-error").removeClass("field-valid"),$input},hideError:function(selector){var $input=$(selector);return this.isForm($input)?this.element($input,"error").hide():$input.parent().removeClass("field-error"),$input},isForm:function($e){return $e.is("form")||$e.is(".form")},element:function($input,type){var $msg=this.isForm($input)?$input.find("> .field-msg ."+type):$input.parent().find(".field-msg ."+type);return $msg.length?$msg:this.create($input,type)},create:function($input,type,msg){var $msgobj,isForm=this.isForm($input),$fieldMsg=isForm?$input.children(".field-msg"):$input.siblings(".field-msg");return $fieldMsg.length||($fieldMsg=$("<div class='field-msg'></div>")[isForm?"prependTo":"insertAfter"]($input)),$msgobj=msg&&"string"!=typeof msg?$(msg):$("<span class='"+type+"'></span>").html(msg),$msgobj.appendTo($fieldMsg)}},Form.PasswordStrength={UI:'<div class="password-strength"><div></div></div>',COLORS:{weak:"#EA0206",fair:"#F2E148",good:"#90EE90",strong:"#1DB232"},_create:function($input){return $(Form.PasswordStrength.UI).appendTo($input.parent().css("position","relative"))},init:function(selector,context,pwdlen){$(selector,context).each(function(){var $input=$(this);$input.siblings(".password-strength").length||(Form.PasswordStrength._create($input),$input.keyup(function(){var username=this.form&&this.form.username&&this.form.username.value;$input.attr("ps-username")&&(username=$($input.attr("ps-username"),this.form).val()),Form.PasswordStrength.check(this,username,pwdlen)}))})},getStatus:function(score){return 30>score?"weak":score>=30&&60>score?"fair":score>=60&&80>score?"good":"strong"},getScore:function(username,value){return PasswordStrength.test(username,value).score},check:function(passwordEle,username,pwdlen){var $password=$(passwordEle),value=$password.val().trim(),$ps=$password.siblings(".password-strength");if(value.length>=1){var score=pwdlen&&value.length<pwdlen?"10":Form.PasswordStrength.getScore(username,value),bgColor=Form.PasswordStrength.COLORS[Form.PasswordStrength.getStatus(score)]||Form.PasswordStrength.COLORS.good;$ps.length||($ps=Form.PasswordStrength._create($password));var defaultWidth=0===score?5:score;$ps.show().find("div").width(defaultWidth+"%").css("background-color",bgColor)}else $ps.hide()}},Form.checkEmailDomain={UI:'<div class="za-email-suggestion"><div></div></div>',_create:function($input){return $(Form.checkEmailDomain.UI).appendTo($input.parent().css("position","relative"))},init:function(selector,context,domains,isEmailCheck){return isEmailCheck?void $(selector,context).each(function(){var $input=$(this);$input.siblings(".za-email-suggestion").length||(Form.checkEmailDomain._create($input),$input.blur(function(){Form.checkEmailDomain.check($input,domains.split(","))}))}):!1},check:function(id,domains){var $suggest=id.siblings(".za-email-suggestion");$suggest.length||Form.checkEmailDomain._create(id);var suggestion=Form.checkEmailDomain.getSuggestedDomain(id,domains),oldemail=$('input[name="email"]').val(),domain=oldemail.split("@"),domainpart=domain[1],dvallength=0;if(domainpart){var dval=domainpart.split(".");dvallength=dval.length;var domval=dval[dvallength];length=domval?domval.trim().length:0}for(var whitelist="ymail.com,yahoo.co.,yahoo.com.,hotmail.co.,hotmail.com.,gmx.net,gmx.at,gmx.ch,gmx.com,mail.com,web.com",whitelist_regex=whitelist.split(","),containInWhiteList=!1,i=0;i<whitelist_regex.length;i++)if(domainpart&&domainpart.match(whitelist_regex[i].trim())){containInWhiteList=!0;break}if(dvallength>2)return!1;if(containInWhiteList)return!1;if(suggestion){var emailAddress="<a onclick = \"Form.checkEmailDomain.replaceDomain('"+suggestion.full.trim()+"')\"><span>"+suggestion.address+'</span>@<span class="za-email-domain">'+suggestion.domain+"</span></a>",message=I18N.get("IAM.DOMAIN.CHECK_MESSAGE",emailAddress);id.siblings(".field-msg").children().is(":visible")&&(Form.Message.hideError(id),message="<span class='za-domain-error'>"+I18N.get("IAM.EMAIL.DOMAIN.SUGGESTION.FULL",emailAddress)+"</span>"),$(".za-email-suggestion").html(message)}else $(".za-email-suggestion").remove()},replaceDomain:function(email){$('input[name="email"]').val(email),$(".za-email-suggestion").remove()},getSuggestedDomain:function(id,domains){var suggestedValue="";return $(id).mailcheck({domains:domains,suggested:function(element,suggestion){-1!==suggestion.domain.indexOf(".")&&(suggestedValue=suggestion)},empty:function(){}}),suggestedValue}};var Validator={PATTERN:{STARTS_ALPHA_NUMERIC:/^[A-Za-z0-9]/,ENDS_ALPHA_NUMERIC:/[A-Za-z0-9]$/,CONTINUE_DOT:/([._][._])+/,VALID_CHARS:/^[A-Za-z0-9_\.]+$/,ONLY_NUMERIC:/^[0-9]+$/,EMAIL:/^[\w]([\w\-\.\+\']*)@([\w\-\.]*)(\.[a-zA-Z]{2,22}(\.[a-zA-Z]{2}){0,2})$/i,USERNAME:/^[A-Za-z0-9_.]+$/i,MOBILE:/^([0-9]{8,12})$/},isValid:function(value){return value&&value.trim().length>0},isEmail:function(value){return value&&Validator.PATTERN.EMAIL.test(value.trim())},isUserName:function(value){return value&&Validator.PATTERN.USERNAME.test(value.trim())},isMobile:function(value){return 0!=value.trim().length&&Validator.PATTERN.MOBILE.test(value.trim())},setJQueryMessage:function($validator,msg,element){return msg?($validator.settings.messages[element.name]=I18N.get(msg),!1):!0}};Validator.newPortal=function(value,element){value=value.trim();var msg=null;return value.length<1?msg="IAM.ERROR.PORTAL.MANDATORY":value.length<6||value.length>30?msg="IAM.ERROR.PORTAL.NOOF.CHARS":Validator.PATTERN.STARTS_ALPHA_NUMERIC.test(value)?Validator.PATTERN.VALID_CHARS.test(value)?Validator.PATTERN.CONTINUE_DOT.test(value)?msg="IAM.ERROR.PORTAL.CONSECUTIVE.DOTS":Validator.PATTERN.ENDS_ALPHA_NUMERIC.test(value)?Validator.PATTERN.ONLY_NUMERIC.test(value)&&(msg="IAM.ERROR.PORTAL.ONLYNUMBERS"):msg="IAM.ERROR.PORTAL.ENDSWITH":msg="IAM.ERROR.PORTAL.NAME.RESTRICTION":msg="IAM.ERROR.PORTAL.STARTSWITH",this.settings?Validator.setJQueryMessage(this,msg,element):I18N.get(msg)},Validator.newUsername=function(value,element){value=value.trim();var msg=null;return value.length<1?msg="IAM.ERROR.USERNAME.MANDATORY":value.length<6||value.length>30?msg="IAM.ERROR.USERNAME.NOOF.CHARS":Validator.PATTERN.STARTS_ALPHA_NUMERIC.test(value)?Validator.PATTERN.VALID_CHARS.test(value)?Validator.PATTERN.CONTINUE_DOT.test(value)?msg="IAM.ERROR.USERNAME.CONSECUTIVE.DOTS":Validator.PATTERN.ENDS_ALPHA_NUMERIC.test(value)?Validator.PATTERN.ONLY_NUMERIC.test(value)&&(msg="IAM.ERROR.USERNAME.ATLEAST.ONEALPHA"):msg="IAM.ERROR.USERNAME.ENDSWITH":msg="IAM.ERROR.USERNAME.ONLY.ALPANUMERIC":msg="IAM.ERROR.USERNAME.STARTSWITH",this.settings?Validator.setJQueryMessage(this,msg,element):I18N.get(msg)},Validator.newPassword=function(value,element){var msg=null,f=element&&element.form||this.currentForm;return value=value.trim(),value.length<1?msg="IAM.ERROR.ENTER.LOGINPASS":value.length<userPasswordMinLen?msg="IAM.ERROR.PASS.LEN":value.length>userPasswordMaxLen?msg="IAM.ERROR.PASSWORD.MAXLEN":f&&f.username&&value.trim()==f.username.value.trim()&&(msg="IAM.PASSWORD.POLICY.LOGINNAME"),this.settings?Validator.setJQueryMessage(this,msg,element):I18N.get(msg)},Validator.addDefaultMethods=function(){$.validator&&($.validator.addMethod("portalname",Validator.newPortal),$.validator.addMethod("username",Validator.newUsername),$.validator.addMethod("password",Validator.newPassword),$.validator.addMethod("email",function(value,element){return Validator.isEmail(value)?!0:Validator.setJQueryMessage(this,"IAM.ERROR.EMAIL.INVALID",element)}),$.validator.addMethod("emailormobile",function(value,element){return Validator.isMobile(value)||Validator.isEmail(value)?!0:Validator.setJQueryMessage(this,"IAM.ERROR.EMAIL.OR.MOBILE.INVALID",element)}))},Validator.addDefaultMethods(),function($){$.fn.zaSignUp=function(options){var args=null;if(!options||"object"==typeof options){var formOptions=$.extend(!0,{},$.fn.zaSignUp.defaults,options);options&&options.oncomplete&&(formOptions.x_signup.oncomplete=formOptions.oncomplete,formOptions.oncomplete=null),args=[formOptions]}return this.form.apply(this,args||arguments)},$.fn.zaSignUp.SIGNUP_STATE={ERROR:0,ACCOUNT_CREATED:1,UPDATE_SERVICE_FIELDS:2,SIGNUP_COMPLETED:3},$.fn.zaSignUp.defaults={initError:function(errorCode,msg){"SIGNUP101"==errorCode&&(Form.Message.error(this.element,msg),this.element.find(":input").attr("disabled","true"))},oncomplete:function(){$(".loadingImg").hide()},getConfirmationTemplate:function(){$(".inner-container").css("display","none");var sb=new StringBuilder('<section class="za-confirm">');return sb.append('<div class="za-confirm-container">'),sb.append('<div class="za-confirm-title">').append(I18N.get("IAM.REGISTER.ACCOUNT.CONFIRMATION")).append("</div>"),sb.append('<p class="za-confirm-msg">').append(I18N.get("IAM.SIGNUP.CONFIRMATION.VERIFY.EMAIL")).append("</p>"),sb.append('<p class="za-confirm-note">').append(I18N.get("IAM.SIGNUP.CONFIRMATION.RIGHT.TO.DEACTIVATE")).append(I18N.get("IAM.EMAIL.TIP")).append("</p>"),sb.append('<div class="za-confirm-btn"><input type="button" class="signupbtn" value="').append(I18N.get("IAM.BUTTON.CONTINUE.SIGNIN")+"&#8594;").append('">'),sb.append("</div></div></section>"),sb.toString()},handleConfirmation:function(data){if(!$(".za-confirm").length){var confirmTpl=this.options.getConfirmationTemplate().replace("$EMAIL",data.email);$("body").append(confirmTpl)}$(".za-confirm").height($(document).height()).show().find("input").focus().click(data.doAction),setTimeout(function(){data.doAction()},5e3)},create:function(){var $f=this.element.attr("autocomplete","off"),options=this.options,signupOptions=options.x_signup,requestParams=Util.parseParameter(location.search);signupOptions.params=signupOptions.params||{},signupOptions.params.is_ajax=!0;for(var i=0,len=signupOptions.paramsNames.length;len>i;i++){var paramValue,paramName=signupOptions.paramsNames[i];!signupOptions.params[paramName]&&(paramValue=requestParams[paramName])&&(signupOptions.params[paramName]=paramValue)}$f.find("input[name='password'], input[name='repassword'], input[name='captcha']").data("secret","true"),$.each(["captcha","password","email","username","newsletter","emailormobile"],function(i,v){var $container=$f.find(".za-"+v+"-container"),isRequired=signupOptions[v+"_required"]===!0,isClientPortal=signupOptions.client_portal===!0;if((isRequired||"captcha"==v)&&!$container.find("input[name='"+v+"']").length){if("newsletter"===v&&isClientPortal)return;throw alert(I18N.get("IAM.ERROR.GENERAL")),'"'+v+'" field is not present'}toggleField($container,isRequired)}),signupOptions.allow_signup===!1&&options.initError.call(this,"SIGNUP101",I18N.get("IAM.ERROR.SIGNUP.NOT.ALLOWED"));var captchaDigest=signupOptions.captchaDigest;$f.each(function(idx,ele){reloadCaptcha(idx,ele,0==idx?captchaDigest:null)}),signupOptions.doZLocHandling?injectLocationForm(options):$(".za-region-container").css("display","none")},url:function(){return ZAConstants.getAbsoluteURL("/accounts/register.ac")},params:function(){return this.options.x_signup.params},crossdomain:!0,csrf:!1,success:signupResponse,error:function(jqXHR){Form.Message.error(this.element,I18N.get("IAM.ERROR.GENERAL")),this.options.x_signup.oncomplete&&this.options.x_signup.oncomplete.call(this,$.fn.zaSignUp.SIGNUP_STATE.ERROR,jqXHR)},validator:{rules:{captcha:"required",portalname:{portalname:!0,validateRemote:!0},username:{username:!0,validateRemote:!0},lastname:"required",password:"password",emailormobile:{emailormobile:!0,validateRemote:{params:function(){var signupParams=$(this.currentForm).zaSignUp("options").x_signup.params;return{portal:signupParams.portal}}}},email:{email:!0,validateRemote:{params:function(){var signupParams=$(this.currentForm).zaSignUp("options").x_signup.params;return{portal:signupParams.portal}}}},repassword:"confirmPassword"},messages:{captcha:{required:function(){return I18N.get("IAM.ERROR.WORD.IMAGE")}},lastname:{required:function(){return I18N.get("IAM.ERROR.LASTNAME.MANDATORY")}}},ignore:".ignore-validation"},passwordStrength:".za-password-container input",checkEmail:".za-email-container input",disableSubmit:function(){$(".loadingImg").show(),$("footer").hide(),$(".idpform").is(":visible")&&$(".idpform").hide()}},$.validator.addMethod("confirmPassword",function(value,element){return this.currentForm.password&&value.trim()!=this.currentForm.password.value.trim()?(this.settings.messages[element.name]=I18N.get("IAM.ERROR.WRONG.CONFIRMPASS"),!1):!0}),$.validator.addMethod("validateRemote",function(value,element,param){var validator=this,options=null,formOptions=$(validator.currentForm).zaSignUp("options"),signupOptions=formOptions.x_signup;if(0==element.name.indexOf(CrossServiceRequest.CONSTANTS.CUSTOM_FIELD)){var customFieldData=CrossServiceRequest.toJSON("za_signup",this.currentForm,{validate:element.name});customFieldData&&(options=CrossServiceRequest.getAjaxOptions(signupOptions.appName,"vfields"),options.data=$.zaParam({data:JSON.stringify(customFieldData)}))}else{var pdata=param&&Util.valueOf(param.params,validator)||{};options={url:ZAConstants.getAbsoluteURL("/accounts/validate/register.ac"),type:"POST",data:pdata},options.data[element.name]=$(element).val(),options.data.servicename=signupOptions.appName,options.data.m_redirect=signupOptions.m_redirect,signupOptions.params&&signupOptions.params.m_redirect&&(options.data.m_redirect=signupOptions.params.m_redirect),signupOptions.params&&signupOptions.params.stop_mredirect&&(options.data.stop_mredirect=signupOptions.params.stop_mredirect)}if(options){if(validator.optional(element))return"dependency-mismatch";var previous=validator.previousValue(element);return validator.settings.messages[element.name]||(validator.settings.messages[element.name]={}),previous.originalMessage=this.settings.messages[element.name].remote,validator.settings.messages[element.name].remote=previous.message,param="string"==typeof param&&{url:param}||param,validator.pending[element.name]?"pending":previous.old===value?previous.valid:(previous.old=value,validator.startRequest(element),CrossServiceRequest.send($.extend(!0,{url:param,mode:"abort",port:"validate"+element.name,dataType:"json",success:function(json){validator.settings.messages[element.name].validateRemote=previous.originalMessage;var valid=null==json.error;if(valid){var submitted=validator.formSubmitted;validator.prepareElement(element),validator.formSubmitted=submitted,validator.successList.push(element),validator.showErrors()}else{var errors=I18N.get(json.error);validator.settings.messages[element.name].validateRemote=previous.message=errors[element.name],validator.showErrors(errors),"x_"==element.name.slice(0,2)&&customFieldAudit(element.name,errors[element.name])}previous.valid=valid,validator.stopRequest(element,valid),param&&$.isFunction(param.success)&&param.success.call(validator,json,element)}},options),formOptions.usePostMessage),"pending")}return!0})}(jQuery);var FederatedSignIn={GO:function(idp){var zaOptionsParam=$.fn.zaSignUp.defaults,servicename=zaOptionsParam.x_signup.appName,serviceurl=zaOptionsParam.x_signup.redirectAppUrl,csrfparam=zaOptionsParam.x_signup.csrfParamName,csrfValue=zaOptionsParam.x_signup.csrfValue,fbRequestUrl=zaOptionsParam.x_signup.facebookUrl,googleRequestUrl=zaOptionsParam.x_signup.googleUrl,openidRequestUrl=zaOptionsParam.x_signup.openidUrl,signupParams=zaOptionsParam.x_signup.params,openidurl=FederatedSignIn.getOpenIdUrl(idp),newurl=ZAConstants.getAccountsServer(),oldurl=newurl,idpClass=$(".idpform").is(":visible"),openid_val="/openid";idpClass||(("g"==idp||"ga"==idp)&&(openid_val="/goauth"),FederatedSignIn.crete(oldurl+openid_val));var $f=$(document.idpform);$f.find(":input").remove(),signupParams.scopes&&$f.append('<input type="hidden" name="scopes" value="'+signupParams.scopes+'">'),signupParams.appname&&$f.append('<input type="hidden" name="appname" value="'+signupParams.appname+'">'),signupParams.getticket&&$f.append('<input type="hidden" name="getticket" value="'+signupParams.getticket+'">'),openidurl&&$f.append('<input type="hidden" name="identifier" value="'+openidurl+'">'),servicename&&$f.append('<input type="hidden" name="servicename" value="'+servicename+'">'),serviceurl&&$f.append('<input type="hidden" name="serviceurl" value="'+serviceurl+'">');var action=openidRequestUrl;"f"==idp?action=fbRequestUrl:"t"==idp?action="/accounts/fsrequest?provider=TWITTER":"l"==idp?action="/accounts/fsrequest?provider=LINKEDIN":("g"==idp||"ga"==idp)&&(action=googleRequestUrl),0===action.lastIndexOf("/accounts/fsrequest",0)&&csrfparam&&$f.append('<input type="hidden" name="'+csrfparam+'" value="'+csrfValue+'">'),$f.attr({action:oldurl+action,method:"post",novalidate:"true"}),"ga"===idp?($f.submit(validateGApp),$f.append('<input type="text" class="small-input gapptext" placeholder="'+I18N.get("IAM.SIGNIN.IDP.GAPPS.DOMAIN")+'" name="domain" autofocus/>'),$f.append('<input type="submit" class="signupbtn openidbtn" value="Submit">'),$(".gapptext").focus()):document.idpform.submit()},getOpenIdUrl:function(idpval){return"g"===idpval?"https://www.google.com/accounts/o8/id":"ga"===idpval?"https://www.google.com/accounts/o8/site-xrds?hd=":"y"===idpval?"https://me.yahoo.com/":"l"===idpval?"https://www.linkedin.com/secure/developer":"t"===idpval?"https://apps.twitter.com/":""},crete:function(url){var idp_form=document.createElement("form");idp_form.name="idpform",idp_form.method="post",idp_form.action=url,idp_form.className="idpform",$("body").append(idp_form)}};$("#newsletter").focusin(function(){$("#signup-newsletter").addClass("focus"),$(document).on("keydown.tabindex",function(e){return 9===e.keycode?($("#submitBtn").focus(),e.preventDefault(),!1):void 0})}).focusout(function(){$("#signup-newsletter").removeClass("focus"),$(document).off("keydown.tabindex")});function StringBuilder(_iv){var arr=_iv?[_iv]:[];this.append=function(v){return arr.push(v),this},this.toString=function(){return arr.join("")},this.isEmpty=function(){return this.length()<1},this.length=function(){return arr.length}}function getSubDomain(domain){for(var i=0,sdomain=domain,p=sdomain.split("."),s="_zagd"+(new Date).getTime();i<p.length-1&&-1==document.cookie.indexOf(s+"="+s);)sdomain=p.slice(-1-++i).join("."),document.cookie=s+"="+s+";domain="+sdomain+";";return document.cookie=s+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;domain="+sdomain+";",sdomain}function reloadCaptcha(idx,f,cdigest){if(f=f||idx,!f.captcha.disabled){var captchaCallback=function(cdigest){var $captcha=$(f).find(".za-captcha").attr("src",ZAConstants.getAbsoluteURL("/accounts/captcha?cdigest="+cdigest));f.cdigest||$("<input type='hidden' name='cdigest' value='"+cdigest+"'>").insertAfter($captcha),f.cdigest.value=cdigest,f.captcha.value="",f.captcha.autocomplete="off"};if(cdigest)captchaCallback(cdigest);else{var options={url:ZAConstants.getAbsoluteURL("/accounts/captcha"),type:"post",data:{action:"newcaptcha"},success:captchaCallback};window.CrossServiceRequest?CrossServiceRequest.send(options,!0):$.ajax(options)}}}function toggleField($container,show){show?$container.show().find(":input").removeAttr("disabled"):$container.hide().find(":input").attr("disabled","true")}function AjaxResponse(json){"string"==typeof json&&(json=$.parseJSON(json)),this.json=json,this.type=json[AjaxResponse.FIELDS.TYPE],this.error=json[AjaxResponse.FIELDS.ERROR],this.data=json[AjaxResponse.FIELDS.DATA]}function Form($form,options){var _this=this;if(_this.element=$form,_this.options=options=$.extend(!0,{},$.fn.form.defaults,options),_this._normalizeOptions(),_this.element.attr({action:options.url,method:options.method}),_this._initHints(),options.validator&&(this.validator=this.element.validate(options.validator)),options.passwordStrength){var pwdlen="";options.x_signup&&options.x_signup.minpwdlen&&(pwdlen=options.x_signup.minpwdlen),Form.PasswordStrength.init(options.passwordStrength,_this.element,pwdlen)}options.checkEmail&&Form.checkEmailDomain.init(options.checkEmail,_this.element,options.x_signup.domains,options.x_signup.isEmailCheck),_this.element.submit(function(event){_this.submit(event)}),options.create&&options.create.call(this),$.fn.zPlaceHolder&&options.zplaceholder_fallback&&_this.element.find("input[placeholder]").zPlaceHolder()}function signupResponse(json,textStatus,jqXHR){try{var jr=JSON.parse(json);if(jr&&"success"==jr.status)return void(window.parent.location.href=jr.redirecturl)}catch(e){}var ar=new AjaxResponse(json);if(ar.error){var f=this.element.get(0);return Form.Message.error(this.element,ar.error.msg),reloadCaptcha(f),!1}var data=ar.data,_this=this,statusCode=data.httpResponseCode,isSuccess=statusCode>=200&&300>statusCode,representation=data.representation[0],f=_this.element.get(0),$f=$(f),signupOptions=_this.options.x_signup;if(isSuccess){signupOptions.oncomplete&&signupOptions.oncomplete.call(_this,$.fn.zaSignUp.SIGNUP_STATE.ACCOUNT_CREATED,jqXHR);var customFieldData=CrossServiceRequest.toJSON("za_signup",f);if(customFieldData){var url=representation.redirect_uri,qs=representation.token_params,idx=url.indexOf(qs),params="data="+Util.euc(JSON.stringify(customFieldData));if(representation.oauthorize_uri){var options={url:representation.oauthorize_uri,type:"post",data:{is_ajax:!0}};CrossServiceRequest.send(options,_this.options.usePostMessage);var ouri=representation.oauthorize_uri,stateParam="state=",allParams=ouri.slice(ouri.indexOf(stateParam)+stateParam.length);url=decodeURIComponent(allParams.slice(0,allParams.indexOf("&")))}else params+=qs?"&"+qs:"";return CrossServiceRequest.sendToApp(signupOptions.appName,"ufields",params,{complete:function(){if(signupOptions.oncomplete&&signupOptions.oncomplete.call(_this,$.fn.zaSignUp.SIGNUP_STATE.UPDATE_SERVICE_FIELDS,jqXHR),-1!=idx){var tmpqs=(-1!=url.indexOf("?"+qs)?"?":"&")+qs;url=url.replace(tmpqs,"")}representation.redirect_uri=url,signupSucceed(_this,representation)}},_this.options.usePostMessage)}signupSucceed(_this,representation)}else{if("400"==data.httpResponseCode&&representation.redirect_uri)window.location.href=representation.redirect_uri;else if(data.errorCode){var errorObj={},errorCode=data.errorCode;if("A110"==errorCode)errorObj.captcha=I18N.get("IAM.ERROR.INVALID_IMAGE_TEXT");else if("U101"==errorCode)data.errorCause.indexOf("Invalid Mobile Number")>0?errorObj.emailormobile=I18N.get("IAM.MOBILE.ENTER.INVALID.MOBILE"):errorObj.username=data.localizedMessage;else if("U102"==errorCode)errorObj.email=data.localizedMessage;else if("U103"==errorCode)errorObj.password=data.localizedMessage;else if("PP101"===errorCode)errorObj.password=data.localizedMessage;else if("PP106"===errorCode)errorObj.password=data.localizedMessage;else if("Z114"==errorCode)errorObj.emailormobile=I18N.get("IAM.ERROR.PHONENUMBER.MOBILE.ALREADY.EXISTS");else if("Z102"==errorCode)"useremail"==data.errorResource||"emaild"==data.errorResource?errorObj.email=I18N.get("IAM.ERROR.EMAIL.EXISTS"):"username"==data.errorResource||"screenname"==data.errorResource?errorObj.username=I18N.get("IAM.ERROR.USERNAME.NOT.AVAILABLE"):errorObj.portal=I18N.get("IAM.ERROR.PORTAL.EXISTS");else if("INPUT_ERROR_102"==errorCode){if(data.errorColumn)for(var i in data.errorColumn){var column=data.errorColumn[i],field=f[column]||f[CrossServiceRequest.CONSTANTS.RESOURCE_FIELD+column];field&&(errorObj[field.name]=I18N.get("IAM.ERROR.VALID.VALUE"))}}else errorObj="Z112"==errorCode?I18N.get("IAM.ERROR.DIFFERENT.REGION",data.errorResource):data.localizedMessage||I18N.get("IAM.ERROR.GENERAL");"string"==typeof errorObj?Form.Message.error($f,errorObj):($.each(["captcha","password","email","username"],function(i,v){errorObj[v]&&f[v]&&f[v].disabled&&toggleField($f.find(".za-"+v+"-container"),!0)}),_this.showErrors(errorObj))}else Form.Message.error($f,I18N.get("IAM.ERROR.GENERAL"));reloadCaptcha(f),signupOptions.oncomplete&&signupOptions.oncomplete.call(_this,$.fn.zaSignUp.SIGNUP_STATE.ERROR,jqXHR)}}function signupSucceed(signup,representation){if(signup.options.x_signup.oncomplete&&signup.options.x_signup.oncomplete.call(signup,$.fn.zaSignUp.SIGNUP_STATE.SIGNUP_COMPLETED),!representation.email)return void(window.location.href=representation.redirect_uri);var doActionCalled=!1;signup.options.handleConfirmation.call(signup,{email:representation.email,doAction:function(){doActionCalled||(doActionCalled=!0,window.location.href=representation.redirect_uri)}})}function customFieldAudit(field,error){$.post(ZAConstants.getAbsoluteURL("/accounts/regaudit/customfield"),{field:field,error:error})}function showPassword(t){var passwordEle=$(".form .za-password-container input")[0];"password"==passwordEle.type?($(t).html(I18N.get("IAM.PASSWORD.HIDE")),passwordEle.type="text",passwordEle._zhide_timeout_=setTimeout(function(){showPassword(t)},5e3)):(clearTimeout(passwordEle._zhide_timeout_),$(t).html(I18N.get("IAM.PASSWORD.SHOW")),passwordEle.type="password")}function validateGApp(e){var val=this.domain.value;(!val||val.length<1)&&(Util.stopEvents(e),Form.Message.error(this,I18N.get("IAM.ERROR.IDP.VALID.DOMAIN")))}function togglePasswordField(pl){var password=$("#password"),type="",showpasswordicon=$("#show-password-icon");showpasswordicon.hasClass("uncheckedpass")?(type="text",showpasswordicon.removeClass("uncheckedpass").addClass("checkedpass")):(type="password",showpasswordicon.removeClass("checkedpass").addClass("uncheckedpass"));var input=$("<input>").val(password.val()).attr({id:"password",tabindex:"1",autocomplete:"off",type:type,placeholder:I18N.get("IAM.PASSWORD"),"class":password.attr("class"),name:"password",spellcheck:"false",onkeyup:"checkPasswordStrength("+pl+")",onfocus:"hideMsg(this);showPwdMsg()",onblur:"hideLenError(this,"+pl+")"});password.before(input),selectTextEnd(input[0],input.val().length),password.remove(),input.focus()}function toggleNewsletterField(){var showpasswordicon=$("#signup-newsletter");showpasswordicon.hasClass("unchecked")?(showpasswordicon.removeClass("unchecked").addClass("checked"),$("#newsletter").val(!0)):(showpasswordicon.removeClass("checked").addClass("unchecked"),$("#newsletter").val(!1))}function selectTextEnd(input,inputLen){if(input.setSelectionRange)input.setSelectionRange(inputLen,inputLen);else if(input.createTextRange){var range=input.createTextRange();range.collapse(!0),range.moveStart("character",inputLen),range.moveEnd("character",inputLen),range.select()}}function checkPasswordStrength(pl){$(".show-password").show(),$(".password-strength div").hide();var p_word=$("#password").val(),len=p_word.length,score=Form.PasswordStrength.getScore("",p_word),status=pl>=len?"weak":Form.PasswordStrength.getStatus(score);$("#pwdstrength").removeClass();var bgColor="weak"===status?"#D21C2B":"good"===status||"fair"===status?"#2489d0":"strong"===status?"#21b100":"#D21C2B";$(".pwdtext").css("color",bgColor),len>=pl?($(".pwderror").hide(),$(".pwdparent").css("marginTop","-7px"),$(".pwdparent").css("marginBottom","18px")):pl>len&&($(".pwderror").show(),$(".pwdparent").css("marginTop","0"),$(".pwdparent").css("marginBottom","0")),len>=pl&&"weak"===status?($(".pwdtext").html(I18N.get("fair"===status?"":"")),$("#pwdstrength").addClass("weak")):"fair"===status||"good"===status?($(".pwdtext").html(I18N.get("")),$("#pwdstrength").addClass("good")):"strong"===status?($(".pwdtext").html(I18N.get("")),$("#pwdstrength").addClass("strong")):$(".pwdtext").html("")}function hideMsg(t){Form.Message.hideError(t),$(".za-email-suggestion").is(":visible")&&$(".za-email-suggestion").remove()}function hideLenError(t,n){Form.Message.hideError(t);var p_word=$("#password").val(),len=p_word.length;len>=1&&n>len&&($("#errormg").removeClass("pwderror"),$("#errormg").addClass("dummyerror"),Form.Message.create($(t),"error","").addClass("jqval-error"),$("#password").addClass("temperror"))}function showPwdMsg(){$("#errormg").removeClass("dummyerror"),$("#errormg").addClass("pwderror"),$(".captchaCnt").css("marginTop","0"),$("#password").removeClass("temperror"),$("#errormg").is(":visible")||($("#errormg").slideDown(100),$(".za-newsletter-container label").css("marginTop","2px"))}function injectLocationForm(options){if(isEu(options)){var select=document.createElement("select");select.classList.add("za-region-select"),select.classList.add("ignore-validation"),select.dclpfxcookiename=options.x_signup.dclCookieName,$(select).css("width","115px");var depMap=options.x_signup.zLocations;for(var dep in depMap){var option=document.createElement("option");option.value=depMap[dep].url,option.text=dep,option.code=depMap[dep].code,options.x_signup.zCurLoc==dep&&(option.selected="selected"),select.add(option)}select.onchange=function(e){var form=$(".form"),selectedOption=this.getElementsByTagName("option")[this.selectedIndex];setCookie(this.dclpfxcookiename,selectedOption.code);var acc_url=e.target.value;form.zaSignUp("options").ajax.url=acc_url+"/accounts/register.ac",form.zaSignUp("options").url=acc_url+"/accounts/register.ac",ZAConstants.setAccountsServer(acc_url),form.validate().resetForm()},$(".za-region-container").length>0?$(".za-region-container").append(select):$(".form").prepend(select)}else $(".za-region-container").css("display","none")}function setCookie(name,value){var host=document.location.host;host=host.substring(host.indexOf("."));var cookieStr=name+"="+value+";Path=/;";cookieStr+="domain="+host,document.cookie=cookieStr}function isEu(options){var date=new Date;if(date.getTimezoneOffset()<=0&&date.getTimezoneOffset()>=-180){var euTZ=["(CEST)","(WEST)","(WET)","(EET)","(WEST)","(EEST)","(CET)"],thisTZ=date.toString().toUpperCase();for(var i in euTZ)if(thisTZ.indexOf(euTZ[i])>-1)return!0}return options.x_signup.isEU||!1}function checkmblbox(id){var check=de(id);check.checked?($("#checkbx").removeClass("checkedBox"),$("#checkbx").addClass("uncheckBox")):($("#checkbx").removeClass("uncheckBox"),$("#checkbx").addClass("checkedBox"))}var PasswordStrength=function(){var MULTIPLE_NUMBERS_RE=/\d.*?\d.*?\d/,MULTIPLE_SYMBOLS_RE=/[!@#$%^&*?_~].*?[!@#$%^&*?_~]/,UPPERCASE_LOWERCASE_RE=/([a-z].*[A-Z])|([A-Z].*[a-z])/,SYMBOL_RE=/[!@#\$%^&*?_~]/;this.username=null,this.password=null,this.score=0,this.status=null,this.test=function(){return this.score=0,this.containInvalidMatches()?this.status="invalid":(this.score+=this.scoreFor("password_size"),this.score+=this.scoreFor("numbers"),this.score+=this.scoreFor("symbols"),this.score+=this.scoreFor("uppercase_lowercase"),this.score+=this.scoreFor("numbers_chars"),this.score+=this.scoreFor("numbers_symbols"),this.score+=this.scoreFor("symbols_chars"),this.score+=this.scoreFor("only_chars"),this.score+=this.scoreFor("only_numbers"),this.score+=this.scoreFor("username"),this.score+=this.scoreFor("sequences"),this.score+=this.scoreFor("repetitions"),this.score<0&&(this.score=0),this.score>100&&(this.score=100),this.score<35&&(this.status="weak"),this.score>=35&&this.score<70&&(this.status="good"),this.score>=70&&(this.status="strong")),this.score},this.scoreFor=function(name){switch(score=0,name){case"password_size":score=this.password.length<4?-100:4*this.password.length;break;case"numbers":this.password.match(MULTIPLE_NUMBERS_RE)&&(score=5);break;case"symbols":this.password.match(MULTIPLE_SYMBOLS_RE)&&(score=5);break;case"uppercase_lowercase":this.password.match(UPPERCASE_LOWERCASE_RE)&&(score=10);break;case"numbers_chars":this.password.match(/[a-z]/i)&&this.password.match(/[0-9]/)&&(score=15);break;case"numbers_symbols":this.password.match(/[0-9]/)&&this.password.match(SYMBOL_RE)&&(score=15);break;case"symbols_chars":this.password.match(/[a-z]/i)&&this.password.match(SYMBOL_RE)&&(score=15);break;case"only_chars":this.password.match(/^[a-z]+$/i)&&(score=-15);break;case"only_numbers":this.password.match(/^\d+$/i)&&(score=-15);break;case"username":this.password==this.username?score=-100:-1!=this.password.indexOf(this.username)&&(score=-15);break;case"sequences":score+=-15*this.sequences(this.password),score+=-15*this.sequences(this.reversed(this.password));break;case"repetitions":score+=-(4*this.repetitions(this.password,2)),score+=-(3*this.repetitions(this.password,3)),score+=-(2*this.repetitions(this.password,4))}return score},this.isGood=function(){return"good"==this.status},this.isWeak=function(){return"weak"==this.status},this.isStrong=function(){return"strong"==this.status},this.isInvalid=function(){return"invalid"==this.status},this.isValid=function(level){return"strong"==level?this.isStrong():"good"==level?this.isStrong()||this.isGood():!this.containInvalidMatches()},this.containInvalidMatches=function(){return this.exclude&&this.exclude.test?this.exclude.test(this.password.toString()):!1},this.sequences=function(text){for(var previousCode,currentCode,matches=0,sequenceSize=0,codes=[],len=text.length,i=0;len>i;i++)currentCode=text.charCodeAt(i),previousCode=codes[codes.length-1],codes.push(currentCode),previousCode&&(currentCode==previousCode+1||previousCode==currentCode?sequenceSize+=1:sequenceSize=0),2==sequenceSize&&(matches+=1);return matches},this.repetitions=function(text,size){for(var substring,occurrences,tmpText,count=0,matches={},len=text.length,i=0;len>i;i++)if(substring=text.substr(i,size),occurrences=0,tmpText=text,!(matches[substring]||substring.length<size)){for(matches[substring]=!0;-1!=(i=tmpText.indexOf(substring));)occurrences+=1,tmpText=tmpText.substr(i+1);occurrences>1&&(count+=1)}return count},this.reversed=function(text){for(var newText="",len=text.length,i=len-1;i>=0;i--)newText+=text.charAt(i);return newText}};PasswordStrength.test=function(username,password){return strength=new PasswordStrength,strength.username=username,strength.password=password,strength.test(),strength},function(b){b.fn.mailcheck=function(a,b){var d="yahoo.com,google.com,hotmail.com,gmail.com,me.com,aol.com,mac.com,live.com,comcast.net,googlemail.com,msn.com,hotmail.co.uk,yahoo.co.uk,facebook.com,verizon.net,sbcglobal.net,att.net,gmx.com,mail.com".split(","),e="co.uk,com,net,org,info,edu,gov,mil".split(",");if("object"==typeof a&&void 0===b)a.domains=a.domains||d;else{var g=a,a=b;a.domains=g||d}a.topLevelDomains=a.topLevelDomains||e,a.distanceFunction=Kicksend.sift3Distance,(d=Kicksend.mailcheck.suggest(encodeURI(this.val()),a.domains,a.topLevelDomains,a.distanceFunction))?a.suggested&&a.suggested(this,d):a.empty&&a.empty(this)}}(jQuery);var Kicksend={mailcheck:{threshold:3,suggest:function(b,a,c,d){if(b=b.toLowerCase(),b=this.splitEmail(b),a=this.findClosestDomain(b.domain,a,d)){if(a!=b.domain)return{address:b.address,domain:a,full:b.address+"@"+a}}else if(c=this.findClosestDomain(b.topLevelDomain,c),b.domain&&c&&c!=b.topLevelDomain)return a=b.domain,a=a.substring(0,a.lastIndexOf(b.topLevelDomain))+c,{address:b.address,domain:a,full:b.address+"@"+a};return!1},findClosestDomain:function(b,a,c){var d,e=99,g=null;if(!b||!a)return!1;c||(c=this.sift3Distance);for(var f=0;f<a.length;f++){if(b===a[f])return b;d=c(b,a[f]),e>d&&(e=d,g=a[f])}return e<=this.threshold&&null!==g?g:!1},sift3Distance:function(b,a){if(null==b||0===b.length)return null==a||0===a.length?0:a.length;if(null==a||0===a.length)return b.length;for(var c=0,d=0,e=0,g=0;c+d<b.length&&c+e<a.length;){if(b.charAt(c+d)==a.charAt(c+e))g++;else for(var f=e=d=0;5>f;f++){if(c+f<b.length&&b.charAt(c+f)==a.charAt(c)){d=f;break}if(c+f<a.length&&b.charAt(c)==a.charAt(c+f)){e=f;break}}c++}return(b.length+a.length)/2-g},splitEmail:function(b){if(b=b.split("@"),2>b.length)return!1;for(var a=0;a<b.length;a++)if(""===b[a])return!1;var c=b.pop(),d=c.split("."),e="";if(0==d.length)return!1;if(1==d.length)e=d[0];else{for(a=1;a<d.length;a++)e+=d[a]+".";2<=d.length&&(e=e.substring(0,e.length-1))}return{topLevelDomain:e,domain:c,address:b.join("@")}}}},ZAConstants={csrfParam:null,csrfCookie:null,contextpath:"/accounts",load:function(json){this.config=json,$.each("accountsServer,csrfParam,csrfCookie,js_url,css_url,img_url".split(","),function(i,key){var v=json[key];v&&(ZAConstants[key]=v)})},setAccountsServer:function(serverURL){if(-1==serverURL.indexOf("://"))throw"Invalid Protocol given for the URL : "+serverURL;this.accountsServer=serverURL,this.schemeLessAccountsServer=null},getAccountsServer:function(){return!this.schemeLessAccountsServer&&this.accountsServer&&(this.schemeLessAccountsServer=this.accountsServer.substring(this.accountsServer.indexOf("://")+1)),this.schemeLessAccountsServer},getAbsoluteURL:function(path){return this.getAccountsServer()+path}};$.isFunction(String.prototype.trim)||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});var _xxxHTTP="http__://".replace("__",""),_xxxHTTPS="https__://".replace("__","");!function($){function processField(idx,input){var $input=$(input),placeholder=$input.attr("placeholder");$input.attr("title")||$input.attr("title",placeholder);var $overlay=$("<span />").addClass("zph-overlay").html(placeholder).css("font-size",$(input).css("font-size"));$input.removeAttr("placeholder").keydown(toggleClass).parent().addClass("zph-placeholder").prepend($overlay),$overlay.click(function(){$input.focus()}),toggleClass(null,$input)}function toggleClass(e,t){var $input=$(t||this);setTimeout(function(){var value=$input.val();0==value?$input.parent().removeClass("zph-hide").addClass("zph-show"):$input.parent().removeClass("zph-show").addClass("zph-hide")},0)}$.support.zplaceholder="placeholder"in document.createElement("input"),$.fn.zPlaceHolder=function(){(!$.support.zplaceholder||$.browser&&$.browser.msie&&!(parseInt($.browser.version)<10))&&this.each(processField)}}(jQuery);var Cookie={add:function(cn,cv,domain,maxage,secure){document.cookie=cn+"="+escape(cv)+";path=/"+(domain?";domain="+domain:"")+(maxage?";max-age="+maxage:"")+(secure?";secure="+secure:"")},get:function(cn){if(document.cookie.length>0){var beginIdx=document.cookie.indexOf(cn+"=");if(-1!=beginIdx){beginIdx=beginIdx+cn.length+1;var endIdx=document.cookie.indexOf(";",beginIdx);return-1==endIdx&&(endIdx=document.cookie.length),unescape(document.cookie.substring(beginIdx,endIdx))}}return""},append:function(cn,cv,domain,separator,maxage,secure){var oldcv=Cookie.get(cn),newcv="";newcv=oldcv?oldcv+separator+cv:cv,Cookie.add(cn,newcv,domain,maxage,secure)},remove:function(cn){document.cookie=cn+"=remove;path=/;max-age=0"}},I18N={data:{},load:function(arr){return $.extend(this.data,arr),this},get:function(key,args){if("object"==typeof key){for(var i in key)key[i]=I18N.get(key[i]);return key}var msg=this.data[key]||key;return args?(arguments[0]=msg,Util.format.apply(this,arguments)):msg}},Util={euc:function(value){return encodeURIComponent(value)},duc:function(value){return decodeURIComponent(value)},paramConfigure:function(args){var params=Util.parseParameter(location.search);$("html").hide(),$(document).ready(function(){$.each(params,function(pname,pvalue){pvalue="true"===pvalue;var value=args[pname];"string"==typeof value?$(value)[pvalue?"show":"hide"]():pvalue&&"object"==typeof value?$.each(value,function(selector,attrObj){$(selector).attr(attrObj)}):pvalue&&"function"==typeof value&&args[pname]()})}),$("html").show()},getCSRFValue:function(){return ZAConstants.csrfParam+"="+Util.euc(Cookie.get(ZAConstants.csrfCookie))},addCSRFParam:function(arr){return arr=arr||{},arr[ZAConstants.csrfParam]=Cookie.get(ZAConstants.csrfCookie),arr},parseParameter:function(qs){var paramArr={};if(-1==qs.indexOf("="))return paramArr;"?"==qs.charAt(0)&&(qs=qs.substring(1));for(var params=qs.split("&"),i=0;i<params.length;i++){var pArr=params[i].split("="),pN=decodeURIComponent(pArr[0]),pV=decodeURIComponent(pArr[1]),pOldV=paramArr[pN];pOldV?$.isArray(pOldV)?pOldV.push(pV):paramArr[pN]=[pOldV,pV]:paramArr[pN]=pV}return paramArr},serializeParams:function(obj){var sb=new StringBuilder;for(var k in obj){var v=obj[k];if(v)if(sb.isEmpty()||sb.append("&"),$.isArray(v))for(var first=!0,j=0;j<v.length;j++)first||sb.append("&"),sb.append(Util.euc(k)).append("=").append(Util.euc(v[j])),first=!1;else sb.append(Util.euc(k)).append("=").append(Util.euc(v))}return sb.toString()},stopEvents:function(e){e.stopPropagation?(e.preventDefault(),e.stopPropagation()):(e.cancelBubble=!0,e.returnValue=!1)},includeJSON2:function(){var json=window.JSON;if(!$.isFunction(json&&json.parse&&json.stringify)){var e=document.createElement("script");e.src=ZAConstants.js_url+"/js/tplibs/json2.js",e.type="text/javascript",document.body.appendChild(e)}},redirectToHTTPS:function(){var https=new StringBuilder("h").append("ttps://"),url=window.location.href;if(0!=url.indexOf(https)){var http=new StringBuilder("h").append("ttp://"),port=window.location.port;(0==port.length||"80"==port||"8080"==port)&&(window.location.href=url.replace(http,https).replace("8080","8443"))}},format:function(msg){if(msg)for(var i=1;i<arguments.length;i++)msg=msg.replace(new RegExp("\\{"+(i-1)+"\\}","g"),arguments[i]);return msg},updateOrigin:function(d){var domain=d||location.hostname,subdomain=getSubDomain(domain);return document.domain!==subdomain?(document.domain=subdomain,subdomain):void 0},valueOf:function(value,context){return $.isFunction(value)?value.call(context||this):value},getServerURL:function(url){if(0===url.indexOf("//")&&(url=window.location.protocol+url),0!==url.indexOf(_xxxHTTP)&&0!==url.indexOf(_xxxHTTPS))return null;var idx=url.indexOf("/",8);return-1===idx?url:url.substring(0,idx)}};AjaxResponse.FIELDS={TYPE:"t",ERROR:"error",DATA:"data"};var CrossServiceRequest={CONSTANTS:{RESOURCE_FIELD:"r_",CUSTOM_FIELD:"x_"},appURLs:{},currentForm:null,corsOptions:{type:"POST",crossDomain:!0,xhrFields:{withCredentials:!0}},postMessageOptions:{data:{_pmsg:!0}},jsSameOriginOptions:{data:{_corsfn:"CrossServiceRequest.handleFrameCallback"}},send:function(url,_options,usePostMessage){var options=options||{};if("object"==$.type(url)?(usePostMessage=_options,options=url):$.isFunction(options)?options={url:url,success:options}:(options.url=url,usePostMessage=options),0!=options.url.indexOf("http")&&0!=options.url.indexOf("//")&&(options.url=ZAConstants.getAbsoluteURL(options.url)),$.support.cors&&!usePostMessage)options=$.extend(!0,{},options,this.corsOptions),$.ajax(options);else{usePostMessage=usePostMessage&&!!window.postMessage;var iframeOptions=usePostMessage?this.postMessageOptions:this.jsSameOriginOptions,isDataInString=options.data&&"string"==$.type(options.data);if(isDataInString){var actualData=options.data;options=$.extend(!0,{},options,iframeOptions),options.data=actualData+"&"+$.zaParam(iframeOptions.data)}else options=$.extend(!0,{},options,iframeOptions);this.currentIFrame=CrossServiceRequest.insertCORSFrame();var $form=$("<form></form>",{action:options.url,method:"POST",autocomplete:"off",target:"corsFrame"});$.each(isDataInString?options.data.split("&"):options.data,function(k,v,i){if(isDataInString){i=k;var vArr=v.split("=");k=Util.duc(vArr[0]),v=Util.duc(vArr[1])}$("<input>",{type:"hidden",name:k,value:v}).appendTo($form)}),this.currentForm=$form.appendTo(document.body).data("__cors_options__",options),usePostMessage?$(window).one("message",{requestURL:options.url},CrossServiceRequest.handleReceiveMessage):Util.updateOrigin(),this.currentForm.submit()}},insertCORSFrame:function(){var $frame=$("iframe[name='corsFrame']");return $frame.length||($frame=$('<iframe src="'+ZAConstants.img_url+'/images/spacer.gif" name="corsFrame" frameborder="0" scrolling="no" style="display:none;border: none;margin: 0;width: 0;"></iframe>').appendTo(document.body)),$frame},handleResponse:function(data){var options=CrossServiceRequest.currentForm.data("__cors_options__");CrossServiceRequest.currentForm.remove(),CrossServiceRequest.currentForm=null,options.complete&&options.complete.call(options.context||this,data),options.success&&options.success.call(options.context||this,data)},handleFrameCallback:function(data){CrossServiceRequest.handleResponse(data)},handleReceiveMessage:function(_ev){var ev=_ev.originalEvent;if(!ev.origin||Util.getServerURL(_ev.data.requestURL)!==ev.origin)throw new Error("Message recevied from invalid origin. Origin : "+ev.origin+", Expected : "+_ev.data.requestURL);if(!ev.source||ev.source!==CrossServiceRequest.currentIFrame.get(0).contentWindow)throw new Error("Message recevied from invalid source");var data;try{data=$.parseJSON(ev.data)}catch(e){data=ev.data}CrossServiceRequest.handleResponse(data)},toJSON:function(screen,f,extraParams){for(var params={},hasCustomParam=!1,fields=$(f).serializeArray(),i=0;i<fields.length;i++){var field=fields[i],name=field.name;hasCustomParam||0!=name.indexOf(CrossServiceRequest.CONSTANTS.CUSTOM_FIELD)||(hasCustomParam=!0),"true"!=$(f[name]).data("secret")&&(params[name]=field.value)}return hasCustomParam?{v1:$.extend(!0,{screen:screen,params:params},extraParams)}:null},getAjaxOptions:function(appName,method,data,callback){var url=this.appURLs[appName]+"/~za~/"+appName+"/"+method,options={url:url,data:data,type:"POST",dataType:"json"};return $.isFunction(callback)?options.success=callback:callback&&$.extend(!0,options,callback),options},sendToApp:function(appName,method,data,callback,usePostMessage){var options=this.getAjaxOptions(appName,method,data,callback);return CrossServiceRequest.send(options,usePostMessage)}},__za_r20=/\+/g;$.zaParam=function(obj){var str=$.param(obj);return str?str.replace(__za_r20,"%20"):str},$.fn.zaSerialize=function(){return $.zaParam(this.serializeArray())},$.fn.form=function(options){if(!this.length)return this;var f=this.data("__form_obj__");if(f){if("string"==typeof options&&"_"!==options.charAt(0)){var value=f[options];if($.isFunction(f[options]))return value.apply(f,Array.prototype.slice.apply(arguments).splice(1));if(void 0!==value)return value}}else f=new Form(this,options),this.data("__form_obj__",f);return this},$.fn.form.defaults={create:null,url:null,method:"post",params:null,handleParams:null,crossdomain:!1,usePostMessage:!1,csrf:!0,commonerror:!1,success:null,error:null,ajax:{},validator:{},onsubmit:null,oncomplete:null,passwordStrength:null,hints:null,animateError:!0,submitButton:":submit",disableSubmit:!0,zplaceholder_fallback:!0},$.fn.form.validatorOptions={debug:!0,errorElement:"span",onsubmit:!1,onkeyup:function(element){var validator=this,timeoutKey=element.name+"_timeout";validator.za||(validator.za={}),clearTimeout(validator.za[timeoutKey]),validator.za[timeoutKey]=setTimeout(function(){(element.name in validator.submitted||""!=$(element).val())&&validator.element(element)},validator.settings.onkeyupdelay||500)},showErrors:function(errorMap){var $form=$(this.currentForm),options=$form.zaSignUp("options");options.commonerror?$.isEmptyObject(errorMap)?$form.zaSignUp("hideErrors",$form):$form.zaSignUp("showErrors",errorMap):this.defaultShowErrors()},errorPlacement:function(error,$input){Form.Message.create($input,"error",error).addClass("jqval-error")},highlight:function(input){Form.Message.error(input)},unhighlight:function(input){Form.Message.hideError(input)},success:function($error){Form.Message.valid($error.parent().parent())}},Form.prototype._normalizeOptions=function(){var _this=this,options=_this.options;if(options.url=_this._val(options.url)||_this.element.attr("action"),options.method=options.method||_this.element.attr("method"),$.isEmptyObject(options.validator))options.validator=null;else{var oldKeyUp=options.validator.onkeyup;options.validator=$.extend(!0,{},$.fn.form.validatorOptions,options.validator),options.validator.onkeyup=oldKeyUp===!0?$.fn.form.validatorOptions.onkeyup:oldKeyUp||!1}options.ajax=$.extend(!0,{url:options.url,type:options.method,context:_this,complete:_this._complete,success:options.success,error:options.error},options.ajax)},Form.prototype._val=function(value){return $.isFunction(value)?value.call(this):value},Form.prototype._initHints=function(){var _this=this,hints=_this.options.hints;for(var k in hints){var formEle=_this.element[0][k],$input=formEle&&formEle.nodeType===Node.ELEMENT_NODE?$(formEle):_this.element.find(k);Form.Message.element($input,"note").html(_this._val(hints[k]))}return this},Form.prototype._complete=function(jqXHR,textStatus){var _this=this,options=this.options;_this.updateSubmitState(!1),options.oncomplete&&options.oncomplete.call(this,jqXHR,textStatus)},Form.prototype.validate=function(){return this.validator?this.element.valid():!0},Form.prototype.showErrors=function(errorObj){if(this.options.commonerror)for(var i in errorObj)return Form.Message.error(this.element,errorObj[i]),!1;if(this.validator)this.validator.showErrors(errorObj),this.validator.focusInvalid();else{Form.Message.errors(this.element,errorObj);var f=this.element.get(0);for(var i in errorObj)if(f[i]){f[i].focus();break}}},Form.prototype.hideErrors=function(fields){Form.Message.hideErrors(this.element,fields)},Form.prototype.submit=function(event){Util.stopEvents(event);var _this=this,options=_this.options,$errorFields=options.animateError&&_this.element.find(".field-error");if(Form.Message.hideError(_this.element),!_this.validate())return _this.validator.focusInvalid(),options.animateError&&$errorFields.size()==_this.element.find(".field-error").size()&&$errorFields.fadeOut(function(){$(this).fadeIn()}),!1;if(_this.validator&&_this.validator.pendingRequest)return void(_this.validator.formSubmitted=!0);var params=null;if(options.handleParams)params=options.handleParams.call(this);else if(params=_this.element.zaSerialize(),options.csrf&&"post"==options.method&&(params+="&"+Util.getCSRFValue()),options.params){var optParams=this._val(options.params);params+="&"+("object"==typeof optParams?Util.serializeParams(optParams):optParams)}var ajaxOptions=$.extend(!0,{data:params},options.ajax),onSubmitValue=options.onsubmit&&options.onsubmit.call(this,ajaxOptions);return onSubmitValue===!1?!1:(_this.updateSubmitState(!0),void(options.crossdomain===!0?CrossServiceRequest.send(ajaxOptions,options.usePostMessage):$.ajax(ajaxOptions)))},Form.prototype.updateSubmitState=function(disable){var options=this.options;if(options.submitButton&&options.disableSubmit){var $btn=this.element.find(options.submitButton),disableValue=this._val(options.disableSubmit);disable?($btn.attr("disabled","true").addClass("disable-btn"),"string"==typeof disableValue&&$btn.data("za_form_original_value",$btn.val()).val(disableValue)):($btn.removeAttr("disabled").removeClass("disable-btn"),"string"==typeof disableValue&&$btn.val($btn.data("za_form_original_value")||$btn.val()))}},Form.Message={valid:function(selector){var $input=$(selector);return this.isForm($input)?this.element($input,"error").hide():$input.parent().addClass("field-valid"),$input},errors:function($f,obj){for(var k in obj)this.error($f.find("[name='"+k+"']"),obj[k])},hideErrors:function($f,fields){for(var i=0;i<fields.length;i++){var v=fields[i];this.hideError("string"==typeof v?$f.find("[name='"+v+"']"):v)}},error:function(selector,msg){var $input=$(selector);return msg&&this.element($input,"error").html(msg),this.isForm($input)?this.element($input,"error").css("display","block"):$input.parent().addClass("field-error").removeClass("field-valid"),$input},hideError:function(selector){var $input=$(selector);return this.isForm($input)?this.element($input,"error").hide():$input.parent().removeClass("field-error"),$input},isForm:function($e){return $e.is("form")||$e.is(".form")},element:function($input,type){var $msg=this.isForm($input)?$input.find("> .field-msg ."+type):$input.parent().find(".field-msg ."+type);return $msg.length?$msg:this.create($input,type)},create:function($input,type,msg){var $msgobj,isForm=this.isForm($input),$fieldMsg=isForm?$input.children(".field-msg"):$input.siblings(".field-msg");return $fieldMsg.length||($fieldMsg=$("<div class='field-msg'></div>")[isForm?"prependTo":"insertAfter"]($input)),$msgobj=msg&&"string"!=typeof msg?$(msg):$("<span class='"+type+"'></span>").html(msg),$msgobj.appendTo($fieldMsg)}},Form.PasswordStrength={UI:'<div class="password-strength"><div></div></div>',COLORS:{weak:"#EA0206",fair:"#F2E148",good:"#90EE90",strong:"#1DB232"},_create:function($input){return $(Form.PasswordStrength.UI).appendTo($input.parent().css("position","relative"))},init:function(selector,context,pwdlen){$(selector,context).each(function(){var $input=$(this);$input.siblings(".password-strength").length||(Form.PasswordStrength._create($input),$input.keyup(function(){var username=this.form&&this.form.username&&this.form.username.value;$input.attr("ps-username")&&(username=$($input.attr("ps-username"),this.form).val()),Form.PasswordStrength.check(this,username,pwdlen)}))})},getStatus:function(score){return 30>score?"weak":score>=30&&60>score?"fair":score>=60&&80>score?"good":"strong"},getScore:function(username,value){return PasswordStrength.test(username,value).score},check:function(passwordEle,username,pwdlen){var $password=$(passwordEle),value=$password.val().trim(),$ps=$password.siblings(".password-strength");if(value.length>=1){var score=pwdlen&&value.length<pwdlen?"10":Form.PasswordStrength.getScore(username,value),bgColor=Form.PasswordStrength.COLORS[Form.PasswordStrength.getStatus(score)]||Form.PasswordStrength.COLORS.good;$ps.length||($ps=Form.PasswordStrength._create($password));var defaultWidth=0===score?5:score;$ps.show().find("div").width(defaultWidth+"%").css("background-color",bgColor)}else $ps.hide()}},Form.checkEmailDomain={UI:'<div class="za-email-suggestion"><div></div></div>',_create:function($input){return $(Form.checkEmailDomain.UI).appendTo($input.parent().css("position","relative"))},init:function(selector,context,domains,isEmailCheck){return isEmailCheck?void $(selector,context).each(function(){var $input=$(this);$input.siblings(".za-email-suggestion").length||(Form.checkEmailDomain._create($input),$input.blur(function(){Form.checkEmailDomain.check($input,domains.split(","))}))}):!1},check:function(id,domains){var $suggest=id.siblings(".za-email-suggestion");$suggest.length||Form.checkEmailDomain._create(id);var suggestion=Form.checkEmailDomain.getSuggestedDomain(id,domains),oldemail=$('input[name="email"]').val(),domain=oldemail.split("@"),domainpart=domain[1],dvallength=0;if(domainpart){var dval=domainpart.split(".");dvallength=dval.length;var domval=dval[dvallength];length=domval?domval.trim().length:0}for(var whitelist="ymail.com,yahoo.co.,yahoo.com.,hotmail.co.,hotmail.com.,gmx.net,gmx.at,gmx.ch,gmx.com,mail.com,web.com",whitelist_regex=whitelist.split(","),containInWhiteList=!1,i=0;i<whitelist_regex.length;i++)if(domainpart&&domainpart.match(whitelist_regex[i].trim())){containInWhiteList=!0;break}if(dvallength>2)return!1;if(containInWhiteList)return!1;if(suggestion){var emailAddress="<a onclick = \"Form.checkEmailDomain.replaceDomain('"+suggestion.full.trim()+"')\"><span>"+suggestion.address+'</span>@<span class="za-email-domain">'+suggestion.domain+"</span></a>",message=I18N.get("IAM.DOMAIN.CHECK_MESSAGE",emailAddress);id.siblings(".field-msg").children().is(":visible")&&(Form.Message.hideError(id),message="<span class='za-domain-error'>"+I18N.get("IAM.EMAIL.DOMAIN.SUGGESTION.FULL",emailAddress)+"</span>"),$(".za-email-suggestion").html(message)}else $(".za-email-suggestion").remove()},replaceDomain:function(email){$('input[name="email"]').val(email),$(".za-email-suggestion").remove()},getSuggestedDomain:function(id,domains){var suggestedValue="";return $(id).mailcheck({domains:domains,suggested:function(element,suggestion){-1!==suggestion.domain.indexOf(".")&&(suggestedValue=suggestion)},empty:function(){}}),suggestedValue}};var Validator={PATTERN:{STARTS_ALPHA_NUMERIC:/^[A-Za-z0-9]/,ENDS_ALPHA_NUMERIC:/[A-Za-z0-9]$/,CONTINUE_DOT:/([._][._])+/,VALID_CHARS:/^[A-Za-z0-9_\.]+$/,ONLY_NUMERIC:/^[0-9]+$/,EMAIL:/^[\w]([\w\-\.\+\']*)@([\w\-\.]*)(\.[a-zA-Z]{2,22}(\.[a-zA-Z]{2}){0,2})$/i,USERNAME:/^[A-Za-z0-9_.]+$/i,MOBILE:/^([0-9]{8,12})$/},isValid:function(value){return value&&value.trim().length>0},isEmail:function(value){return value&&Validator.PATTERN.EMAIL.test(value.trim())},isUserName:function(value){return value&&Validator.PATTERN.USERNAME.test(value.trim())},isMobile:function(value){return 0!=value.trim().length&&Validator.PATTERN.MOBILE.test(value.trim())},setJQueryMessage:function($validator,msg,element){return msg?($validator.settings.messages[element.name]=I18N.get(msg),!1):!0}};Validator.newPortal=function(value,element){value=value.trim();var msg=null;return value.length<1?msg="IAM.ERROR.PORTAL.MANDATORY":value.length<6||value.length>30?msg="IAM.ERROR.PORTAL.NOOF.CHARS":Validator.PATTERN.STARTS_ALPHA_NUMERIC.test(value)?Validator.PATTERN.VALID_CHARS.test(value)?Validator.PATTERN.CONTINUE_DOT.test(value)?msg="IAM.ERROR.PORTAL.CONSECUTIVE.DOTS":Validator.PATTERN.ENDS_ALPHA_NUMERIC.test(value)?Validator.PATTERN.ONLY_NUMERIC.test(value)&&(msg="IAM.ERROR.PORTAL.ONLYNUMBERS"):msg="IAM.ERROR.PORTAL.ENDSWITH":msg="IAM.ERROR.PORTAL.NAME.RESTRICTION":msg="IAM.ERROR.PORTAL.STARTSWITH",this.settings?Validator.setJQueryMessage(this,msg,element):I18N.get(msg)},Validator.newUsername=function(value,element){value=value.trim();var msg=null;return value.length<1?msg="IAM.ERROR.USERNAME.MANDATORY":value.length<6||value.length>30?msg="IAM.ERROR.USERNAME.NOOF.CHARS":Validator.PATTERN.STARTS_ALPHA_NUMERIC.test(value)?Validator.PATTERN.VALID_CHARS.test(value)?Validator.PATTERN.CONTINUE_DOT.test(value)?msg="IAM.ERROR.USERNAME.CONSECUTIVE.DOTS":Validator.PATTERN.ENDS_ALPHA_NUMERIC.test(value)?Validator.PATTERN.ONLY_NUMERIC.test(value)&&(msg="IAM.ERROR.USERNAME.ATLEAST.ONEALPHA"):msg="IAM.ERROR.USERNAME.ENDSWITH":msg="IAM.ERROR.USERNAME.ONLY.ALPANUMERIC":msg="IAM.ERROR.USERNAME.STARTSWITH",this.settings?Validator.setJQueryMessage(this,msg,element):I18N.get(msg)},Validator.newPassword=function(value,element){var msg=null,f=element&&element.form||this.currentForm;return value=value.trim(),value.length<1?msg="IAM.ERROR.ENTER.LOGINPASS":value.length<userPasswordMinLen?msg="IAM.ERROR.PASS.LEN":value.length>userPasswordMaxLen?msg="IAM.ERROR.PASSWORD.MAXLEN":f&&f.username&&value.trim()==f.username.value.trim()&&(msg="IAM.PASSWORD.POLICY.LOGINNAME"),this.settings?Validator.setJQueryMessage(this,msg,element):I18N.get(msg)},Validator.addDefaultMethods=function(){$.validator&&($.validator.addMethod("portalname",Validator.newPortal),$.validator.addMethod("username",Validator.newUsername),$.validator.addMethod("password",Validator.newPassword),$.validator.addMethod("email",function(value,element){return Validator.isEmail(value)?!0:Validator.setJQueryMessage(this,"IAM.ERROR.EMAIL.INVALID",element)}),$.validator.addMethod("emailormobile",function(value,element){return Validator.isMobile(value)||Validator.isEmail(value)?!0:Validator.setJQueryMessage(this,"IAM.ERROR.EMAIL.OR.MOBILE.INVALID",element)}))},Validator.addDefaultMethods(),function($){$.fn.zaSignUp=function(options){var args=null;if(!options||"object"==typeof options){var formOptions=$.extend(!0,{},$.fn.zaSignUp.defaults,options);options&&options.oncomplete&&(formOptions.x_signup.oncomplete=formOptions.oncomplete,formOptions.oncomplete=null),args=[formOptions]}return this.form.apply(this,args||arguments)},$.fn.zaSignUp.SIGNUP_STATE={ERROR:0,ACCOUNT_CREATED:1,UPDATE_SERVICE_FIELDS:2,SIGNUP_COMPLETED:3},$.fn.zaSignUp.defaults={initError:function(errorCode,msg){"SIGNUP101"==errorCode&&(Form.Message.error(this.element,msg),this.element.find(":input").attr("disabled","true"))},oncomplete:function(){$(".loadingImg").hide()},getConfirmationTemplate:function(){$(".inner-container").css("display","none");var sb=new StringBuilder('<section class="za-confirm">');return sb.append('<div class="za-confirm-container">'),sb.append('<div class="za-confirm-title">').append(I18N.get("IAM.REGISTER.ACCOUNT.CONFIRMATION")).append("</div>"),sb.append('<p class="za-confirm-msg">').append(I18N.get("IAM.SIGNUP.CONFIRMATION.VERIFY.EMAIL")).append("</p>"),sb.append('<p class="za-confirm-note">').append(I18N.get("IAM.SIGNUP.CONFIRMATION.RIGHT.TO.DEACTIVATE")).append(I18N.get("IAM.EMAIL.TIP")).append("</p>"),sb.append('<div class="za-confirm-btn"><input type="button" class="signupbtn" value="').append(I18N.get("IAM.BUTTON.CONTINUE.SIGNIN")+"&#8594;").append('">'),sb.append("</div></div></section>"),sb.toString()},handleConfirmation:function(data){if(!$(".za-confirm").length){var confirmTpl=this.options.getConfirmationTemplate().replace("$EMAIL",data.email);$("body").append(confirmTpl)}$(".za-confirm").height($(document).height()).show().find("input").focus().click(data.doAction),setTimeout(function(){data.doAction()},5e3)},create:function(){var $f=this.element.attr("autocomplete","off"),options=this.options,signupOptions=options.x_signup,requestParams=Util.parseParameter(location.search);signupOptions.params=signupOptions.params||{},signupOptions.params.is_ajax=!0;for(var i=0,len=signupOptions.paramsNames.length;len>i;i++){var paramValue,paramName=signupOptions.paramsNames[i];!signupOptions.params[paramName]&&(paramValue=requestParams[paramName])&&(signupOptions.params[paramName]=paramValue)}$f.find("input[name='password'], input[name='repassword'], input[name='captcha']").data("secret","true"),$.each(["captcha","password","email","username","newsletter","emailormobile"],function(i,v){var $container=$f.find(".za-"+v+"-container"),isRequired=signupOptions[v+"_required"]===!0,isClientPortal=signupOptions.client_portal===!0;if((isRequired||"captcha"==v)&&!$container.find("input[name='"+v+"']").length){if("newsletter"===v&&isClientPortal)return;throw alert(I18N.get("IAM.ERROR.GENERAL")),'"'+v+'" field is not present'}toggleField($container,isRequired)}),signupOptions.allow_signup===!1&&options.initError.call(this,"SIGNUP101",I18N.get("IAM.ERROR.SIGNUP.NOT.ALLOWED"));var captchaDigest=signupOptions.captchaDigest;$f.each(function(idx,ele){reloadCaptcha(idx,ele,0==idx?captchaDigest:null)}),signupOptions.doZLocHandling?injectLocationForm(options):$(".za-region-container").css("display","none")},url:function(){return ZAConstants.getAbsoluteURL("/accounts/register.ac")},params:function(){return this.options.x_signup.params},crossdomain:!0,csrf:!1,success:signupResponse,error:function(jqXHR){Form.Message.error(this.element,I18N.get("IAM.ERROR.GENERAL")),this.options.x_signup.oncomplete&&this.options.x_signup.oncomplete.call(this,$.fn.zaSignUp.SIGNUP_STATE.ERROR,jqXHR)},validator:{rules:{captcha:"required",portalname:{portalname:!0,validateRemote:!0},username:{username:!0,validateRemote:!0},lastname:"required",password:"password",emailormobile:{emailormobile:!0,validateRemote:{params:function(){var signupParams=$(this.currentForm).zaSignUp("options").x_signup.params;return{portal:signupParams.portal}}}},email:{email:!0,validateRemote:{params:function(){var signupParams=$(this.currentForm).zaSignUp("options").x_signup.params;return{portal:signupParams.portal}}}},repassword:"confirmPassword"},messages:{captcha:{required:function(){return I18N.get("IAM.ERROR.WORD.IMAGE")}},lastname:{required:function(){return I18N.get("IAM.ERROR.LASTNAME.MANDATORY")}}},ignore:".ignore-validation"},passwordStrength:".za-password-container input",checkEmail:".za-email-container input",disableSubmit:function(){$(".loadingImg").show(),$("footer").hide(),$(".idpform").is(":visible")&&$(".idpform").hide()}},$.validator.addMethod("confirmPassword",function(value,element){return this.currentForm.password&&value.trim()!=this.currentForm.password.value.trim()?(this.settings.messages[element.name]=I18N.get("IAM.ERROR.WRONG.CONFIRMPASS"),!1):!0}),$.validator.addMethod("validateRemote",function(value,element,param){var validator=this,options=null,formOptions=$(validator.currentForm).zaSignUp("options"),signupOptions=formOptions.x_signup;if(0==element.name.indexOf(CrossServiceRequest.CONSTANTS.CUSTOM_FIELD)){var customFieldData=CrossServiceRequest.toJSON("za_signup",this.currentForm,{validate:element.name});customFieldData&&(options=CrossServiceRequest.getAjaxOptions(signupOptions.appName,"vfields"),options.data=$.zaParam({data:JSON.stringify(customFieldData)}))}else{var pdata=param&&Util.valueOf(param.params,validator)||{};options={url:ZAConstants.getAbsoluteURL("/accounts/validate/register.ac"),type:"POST",data:pdata},options.data[element.name]=$(element).val(),options.data.servicename=signupOptions.appName,options.data.m_redirect=signupOptions.m_redirect,signupOptions.params&&signupOptions.params.m_redirect&&(options.data.m_redirect=signupOptions.params.m_redirect),signupOptions.params&&signupOptions.params.stop_mredirect&&(options.data.stop_mredirect=signupOptions.params.stop_mredirect)}if(options){if(validator.optional(element))return"dependency-mismatch";var previous=validator.previousValue(element);return validator.settings.messages[element.name]||(validator.settings.messages[element.name]={}),previous.originalMessage=this.settings.messages[element.name].remote,validator.settings.messages[element.name].remote=previous.message,param="string"==typeof param&&{url:param}||param,validator.pending[element.name]?"pending":previous.old===value?previous.valid:(previous.old=value,validator.startRequest(element),CrossServiceRequest.send($.extend(!0,{url:param,mode:"abort",port:"validate"+element.name,dataType:"json",success:function(json){validator.settings.messages[element.name].validateRemote=previous.originalMessage;var valid=null==json.error;if(valid){var submitted=validator.formSubmitted;validator.prepareElement(element),validator.formSubmitted=submitted,validator.successList.push(element),validator.showErrors()}else{var errors=I18N.get(json.error);validator.settings.messages[element.name].validateRemote=previous.message=errors[element.name],validator.showErrors(errors),"x_"==element.name.slice(0,2)&&customFieldAudit(element.name,errors[element.name])}previous.valid=valid,validator.stopRequest(element,valid),param&&$.isFunction(param.success)&&param.success.call(validator,json,element)}},options),formOptions.usePostMessage),"pending")}return!0})}(jQuery);var FederatedSignIn={GO:function(idp){var zaOptionsParam=$.fn.zaSignUp.defaults,servicename=zaOptionsParam.x_signup.appName,serviceurl=zaOptionsParam.x_signup.redirectAppUrl,csrfparam=zaOptionsParam.x_signup.csrfParamName,csrfValue=zaOptionsParam.x_signup.csrfValue,fbRequestUrl=zaOptionsParam.x_signup.facebookUrl,googleRequestUrl=zaOptionsParam.x_signup.googleUrl,openidRequestUrl=zaOptionsParam.x_signup.openidUrl,signupParams=zaOptionsParam.x_signup.params,openidurl=FederatedSignIn.getOpenIdUrl(idp),newurl=ZAConstants.getAccountsServer(),oldurl=newurl,idpClass=$(".idpform").is(":visible"),openid_val="/openid";idpClass||(("g"==idp||"ga"==idp)&&(openid_val="/goauth"),FederatedSignIn.crete(oldurl+openid_val));var $f=$(document.idpform);$f.find(":input").remove(),signupParams.scopes&&$f.append('<input type="hidden" name="scopes" value="'+signupParams.scopes+'">'),signupParams.appname&&$f.append('<input type="hidden" name="appname" value="'+signupParams.appname+'">'),signupParams.getticket&&$f.append('<input type="hidden" name="getticket" value="'+signupParams.getticket+'">'),openidurl&&$f.append('<input type="hidden" name="identifier" value="'+openidurl+'">'),servicename&&$f.append('<input type="hidden" name="servicename" value="'+servicename+'">'),serviceurl&&$f.append('<input type="hidden" name="serviceurl" value="'+serviceurl+'">');var action=openidRequestUrl;"f"==idp?action=fbRequestUrl:"t"==idp?action="/accounts/fsrequest?provider=TWITTER":"l"==idp?action="/accounts/fsrequest?provider=LINKEDIN":("g"==idp||"ga"==idp)&&(action=googleRequestUrl),0===action.lastIndexOf("/accounts/fsrequest",0)&&csrfparam&&$f.append('<input type="hidden" name="'+csrfparam+'" value="'+csrfValue+'">'),$f.attr({action:oldurl+action,method:"post",novalidate:"true"}),"ga"===idp?($f.submit(validateGApp),$f.append('<input type="text" class="small-input gapptext" placeholder="'+I18N.get("IAM.SIGNIN.IDP.GAPPS.DOMAIN")+'" name="domain" autofocus/>'),$f.append('<input type="submit" class="signupbtn openidbtn" value="Submit">'),$(".gapptext").focus()):document.idpform.submit()},getOpenIdUrl:function(idpval){return"g"===idpval?"https://www.google.com/accounts/o8/id":"ga"===idpval?"https://www.google.com/accounts/o8/site-xrds?hd=":"y"===idpval?"https://me.yahoo.com/":"l"===idpval?"https://www.linkedin.com/secure/developer":"t"===idpval?"https://apps.twitter.com/":""},crete:function(url){var idp_form=document.createElement("form");idp_form.name="idpform",idp_form.method="post",idp_form.action=url,idp_form.className="idpform",$("body").append(idp_form)}};$("#newsletter").focusin(function(){$("#signup-newsletter").addClass("focus"),$(document).on("keydown.tabindex",function(e){return 9===e.keycode?($("#submitBtn").focus(),e.preventDefault(),!1):void 0})}).focusout(function(){$("#signup-newsletter").removeClass("focus"),$(document).off("keydown.tabindex")});